<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Smit, A. J.">
<meta name="dcterms.date" content="2021-01-01">

<title>6. Tidy Data – SAMOS R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../intro_r/07-tidier.html" rel="next">
<link href="../intro_r/05-workflow.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-21fe018c864e78632dc0e35f28f7bac9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">SAMOS R</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../intro_r/01-RStudio.html"> 
<span class="menu-text">Intro to R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../basic_stats/02-summarise-and-describe.html"> 
<span class="menu-text">Biostatistics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tasks/BCB744_Task_A.html"> 
<span class="menu-text">Tasks</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../intro_r/01-RStudio.html">Introduction to R</a></li><li class="breadcrumb-item"><a href="../intro_r/06-tidy.html">6. Tidy Data</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/SAMOS-logo-transparent.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../images/SAMOS-logo-transparent.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction to R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/01-RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/02-working-with-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Working with Data and Code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/03-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. R Markdown and Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/04-data-in-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data Classes and Structures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/05-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. R Workflows</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/06-tidy.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">6. Tidy Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/07-tidier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Tidier Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/08-tidiest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Tidiest Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/09-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Graphics with <strong>ggplot2</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/10-faceting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Faceting Figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/11-brewing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Brewing Colours</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/12-mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Mapping with <strong>ggplot2</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/13-mapping_style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Mapping with Style</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/14-mapping_rnaturalearth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Mapping with Natural Earth</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/15-mapping_quakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15. The Fiji Earthquake Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/16-recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16. Synthesis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/17-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17. Functions by Chapter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/18-base_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">18. Base R Primer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/19-dates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">19. Dates</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Biostatistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/02-summarise-and-describe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Data Summaries &amp; Descriptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/03-visualise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Statistical Figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/04-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/05-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Statistical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/06-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Assumptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/07-t_tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. <em>t</em>-Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/08-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/09-regressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Simple Linear Regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/10-correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/11-decision_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Parametric Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/12-glance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Non-Parametric Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/13-confidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Confidence Intervals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/14-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Data Transformations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Tasks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_A.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_B.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task B</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_C.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_D.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task D</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_E.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task E</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_F.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task F</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_G.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task G</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_H.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task G</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_Bonus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Bonus Task</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#start-with-a-failure" id="toc-start-with-a-failure" class="nav-link active" data-scroll-target="#start-with-a-failure"><span class="header-section-number">1</span> Start With a Failure</a></li>
  <li><a href="#properties-of-tidy-data" id="toc-properties-of-tidy-data" class="nav-link" data-scroll-target="#properties-of-tidy-data"><span class="header-section-number">2</span> Properties of Tidy Data</a></li>
  <li><a href="#different-ways-to-be-untidy" id="toc-different-ways-to-be-untidy" class="nav-link" data-scroll-target="#different-ways-to-be-untidy"><span class="header-section-number">3</span> Different Ways to Be Untidy</a></li>
  <li><a href="#long-and-wide-formatted-data" id="toc-long-and-wide-formatted-data" class="nav-link" data-scroll-target="#long-and-wide-formatted-data"><span class="header-section-number">4</span> Long and Wide Formatted Data</a>
  <ul class="collapse">
  <li><a href="#pivot_longer" id="toc-pivot_longer" class="nav-link" data-scroll-target="#pivot_longer"><span class="header-section-number">4.1</span> <code>pivot_longer()</code></a></li>
  <li><a href="#pivot_wider" id="toc-pivot_wider" class="nav-link" data-scroll-target="#pivot_wider"><span class="header-section-number">4.2</span> <code>pivot_wider()</code></a></li>
  </ul></li>
  <li><a href="#separating-and-uniting" id="toc-separating-and-uniting" class="nav-link" data-scroll-target="#separating-and-uniting"><span class="header-section-number">5</span> Separating and Uniting</a>
  <ul class="collapse">
  <li><a href="#separate" id="toc-separate" class="nav-link" data-scroll-target="#separate"><span class="header-section-number">5.1</span> Separate</a></li>
  <li><a href="#separating-dates-using-mutate" id="toc-separating-dates-using-mutate" class="nav-link" data-scroll-target="#separating-dates-using-mutate"><span class="header-section-number">5.2</span> Separating Dates Using <code>mutate()</code></a></li>
  <li><a href="#unite" id="toc-unite" class="nav-link" data-scroll-target="#unite"><span class="header-section-number">5.3</span> Unite</a></li>
  </ul></li>
  <li><a href="#joining" id="toc-joining" class="nav-link" data-scroll-target="#joining"><span class="header-section-number">6</span> Joining</a></li>
  <li><a href="#putting-it-all-together-an-analysis-ready-dataset" id="toc-putting-it-all-together-an-analysis-ready-dataset" class="nav-link" data-scroll-target="#putting-it-all-together-an-analysis-ready-dataset"><span class="header-section-number">7</span> Putting it All Together: An Analysis-Ready Dataset</a></li>
  <li><a href="#but-why-though" id="toc-but-why-though" class="nav-link" data-scroll-target="#but-why-though"><span class="header-section-number">8</span> But Why Though?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../intro_r/01-RStudio.html">Introduction to R</a></li><li class="breadcrumb-item"><a href="../intro_r/06-tidy.html">6. Tidy Data</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">6. Tidy Data</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Smit, A. J. <a href="https://orcid.org/0000-0002-3799-6126" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://uwc.ac.za">
            University of the Western Cape
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 1, 2021</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><img src="../images/SAMOS-logo-transparent.png" class="img-fluid" style="width:35.0%"></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/accurate.jpg" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption>A reminder that accuracy matters.</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p>“<em>Order and simplification are the first steps toward the mastery of a subject.</em>”</p>
<p>— Thomas Mann</p>
</blockquote>
<blockquote class="blockquote">
<p>“<em>With great data comes great responsibility.</em>”</p>
<p>— Hadley Wickham</p>
</blockquote>
<p>The <a href="http://tidyverse.org">Tidyverse</a> is a collection of R packages designed for data manipulation, exploration, and visualisation. It is based on a philosophy of “tidy data,” which is a standardised way of organising data. The purpose of these packages is to make working with data more efficient. The core Tidyverse packages were created by Hadley Wickham, but over the last few years other individuals have added some packages to the collective, which has significantly expanded our data analytical capabilities through improved ease of use, efficiency. All packages that are built on tidy principles provide the use of a consistent set of tools across a wide range of data analysis tasks. The core Tidyverse packages can be loaded collectively by calling the <strong>tidyverse</strong> package and as we have seen throughout this workshop. The packages making up the Tidyverse are shown in <a href="#fig-tidyverse" class="quarto-xref">Figure&nbsp;1</a>.</p>
<div id="fig-tidyverse" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyverse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../images/tidyverse_website.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyverse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: A tidy workflow.
</figcaption>
</figure>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="start-with-a-failure" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Start With a Failure</h1>
<p>Let’s begin with a deliberately frustrating dataset. The <code>SACTN_mangled.RData</code> file contains the same observations stored in progressively worse formats (SACTN1-4). Load it now:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"BCB744"</span>, <span class="st">"SACTN_mangled.RData"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Try to plot <code>SACTN2</code> (wide format). You will immediately become annoyed and frustrated — columns that <em>look</em> like data are actually variable names, and <code>ggplot2</code> cannot guess your intent.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>A very gentle <code>ggplot2</code> preview (we go deeper later)
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this chapter we use <code>ggplot2</code> only as a <strong>quick visual diagnostic</strong> to check whether our data are in a usable shape.</p>
<p>For now, think of <code>ggplot()</code> as:</p>
<ul>
<li><em>“take a dataset”</em> +</li>
<li><em>“map columns to axes”</em> +</li>
<li><em>“choose a geometry”</em> (points/lines)</li>
</ul>
<p>The full introduction to <code>ggplot2</code> comes later (see the dedicated Graphics chapter).</p>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">ggplot</span>(SACTN2, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> temp)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">geom_line</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>If that error feels annoying, good. The tidy rules exist to prevent <em>this</em> kind of ambiguity.</p>
</section>
<section id="properties-of-tidy-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Properties of Tidy Data</h1>
<p>As you may see in <a href="#fig-tidyworkflow" class="quarto-xref">Figure&nbsp;2</a>, the tidying of ones data should be the second step in any workflow, after loading the data.</p>
<div id="fig-tidyworkflow" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyworkflow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../images/r4ds_data-science.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyworkflow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Data tidying in the data processing pipeline. Reproduced from <a href="http://r4ds.had.co.nz/workflow-basics.html">R for Data Science</a>.
</figcaption>
</figure>
</div>
<p>But what exactly are <strong>tidy data</strong>? It is not just a word I use because I am pedantic, there is a real definition. In three parts, to be exact. Taken from Hadley Wickham’s <a href="http://r4ds.had.co.nz/workflow-basics.html">R for Data Science</a>:</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>The Tidy Principles
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider this example of tidy data:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; # A tibble: 10 × 5
R&gt;    region site                Ind measurement       value
R&gt;    &lt;chr&gt;  &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;
R&gt;  1 WC     Kommetjie            11 stipe_mass         4.2 
R&gt;  2 WC     Kommetjie            11 stipe_length     176   
R&gt;  3 WC     Kommetjie            11 stipe_diameter    76   
R&gt;  4 WC     Kommetjie            11 digits             8   
R&gt;  5 WC     Kommetjie            11 thallus_mass    6500   
R&gt;  6 WC     Kommetjie            11 total_length     354   
R&gt;  7 FB     Bordjiestif North     1 blade_weight       1.75
R&gt;  8 FB     Bordjiestif North     1 blade_length     145   
R&gt;  9 FB     Bordjiestif North     1 blade_thickness    1   
R&gt; 10 FB     Bordjiestif North     1 stipe_mass         0.75</code></pre>
</div>
</div>
<ol type="1">
<li>Each variable must have its own column. Some of the variables tell us <em>about</em> the measurements (the <code>region</code> where the <code>site</code> was located, the replicate number (<code>ind</code>) of the plants sampled, and the nature of the <code>measurement</code> taken), and one variable gives the <code>value</code> of the measurement.</li>
<li>Each measurement must have its own row — the value of <em>each of the things measured</em> must be in its own row; for example, in the <em>Laminaria</em> data the measured things include <code>blade_length</code>, <code>blade_weight</code>, <em>etc.</em>, and they can all be captured in one column named, for example, <code>measurement</code>.</li>
<li>Each <code>value</code> must have its own cell — each of the things that is known and measured must be in its own cell.</li>
</ol>
<p>The core principle of tidy data is represented graphically in <a href="#fig-tidyrules" class="quarto-xref">Figure&nbsp;3</a>). One will generally satisfy these three rules simply by never putting more than one dataset in a file, and never putting more (or less) than one variable in the same column. We will go over this several more times today so do not fret if those guidelines are not immediately clear.</p>
<div id="fig-tidyrules" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyrules-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../images/tidy-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyrules-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Following three rules make a dataset tidy — variables are in columns, observations are in rows, and values are in cells. Reproduced from <a href="http://r4ds.had.co.nz/workflow-basics.html">R for Data Science</a>.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Benefits of Tidy Data
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Grammar of data manipulation</strong> The Tidyverse provides a set of functions and tools for data manipulation that can be combined in a way that is similar to a grammar. This makes it easy to write complex data manipulation tasks, and also makes it easier to read, understand code written by others.</p>
<p><strong>Consistent style</strong> The Tidyverse provides a consistent style for functions and data structures, making it easier to work with multiple packages within the Tidyverse, as well as with other R packages.</p>
<p><strong>Interoperability</strong> The Tidyverse is designed to work seamlessly with other R packages, so that data can be easily moved between different analysis pipelines.</p>
</div>
</div>
</section>
<section id="different-ways-to-be-untidy" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Different Ways to Be Untidy</h1>
<p>Now that you have <em>felt</em> the failure, we will fix it. The SACTN examples contain the same observations in different states of disrepair. The point is not just to tidy the data, but to practise <strong>recognising the pattern of untidiness</strong> and choosing the right tool. This is faster than Excel, and, importantly, it keeps every step in your script — the core of reproducible research.</p>
<p>With the <code>SACTN_mangled.RData</code> data loaded, have a peek at them. You will first see that you have loaded not one, but five different objects into our environment pane in the top right of our RStudio window. These all contain the exact same data in different states of disrepair. As you may have guessed, some of these datasets will be easier to use than others.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>SACTN1</span>
<span id="cb5-2"><a href="#cb5-2"></a>SACTN2</span>
<span id="cb5-3"><a href="#cb5-3"></a>SACTN3</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># Spread across two dataframes</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>SACTN4a</span>
<span id="cb5-7"><a href="#cb5-7"></a>SACTN4b</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Quick Untidiness Diagnostic
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ask these three questions <strong>before</strong> choosing a tool:</p>
<ul>
<li><strong>Do column names contain data values?</strong> → likely <code>pivot_longer()</code></li>
<li><strong>Is more than one variable stored in one column?</strong> → <code>separate_*()</code> / <code>unite()</code></li>
<li><strong>Is more than one observation stored in one row?</strong> → <code>pivot_wider()</code></li>
</ul>
</div>
</div>
<p>Start off by looking at <code>SACTN1</code>. If these data look just like all of the other SACTN data we have used thus far that is because they are. These are how tidy data should look. No surprises. In fact, because these data are already tidy it is very straightforward to use them for whatever purposes we may want. Making a time series plot, for example.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SACTN1, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> temp)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour =</span> site, <span class="at">group =</span> <span class="fu">paste0</span>(site, src))) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Temperature (°C)"</span>, <span class="at">colour =</span> <span class="st">"Site"</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-tidy-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidy-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-tidy_files/figure-html/fig-tidy-1-1.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidy-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: SACTN1 time series by site and source.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="long-and-wide-formatted-data" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Long and Wide Formatted Data</h1>
<p>Before <em>tidy</em> became the adjective used to describe neatly formatted data, people used to say <em>long</em>. This is because well organised dataframes tend to always be longer than they are wide (with the exception of species assemblage data). The opposite of <em>long</em> data are <em>wide</em> data. If you ever find a dataset that is wider than it is long then this is probably because the person that created them saved one variable across many columns.</p>
<p>It may seem odd that so much effort is being spent on something so straightforward as tidy data. Surely this is too obvious to devote an entire day of work to it? Unfortunately not. As you go out into the wild world of “real life data,” you will discover that very few datasets (especially those collected by hand) are tidy. Rather they are plagued by any number of issues. The first step then for tidying up the data is to have a look at them, separate the observations that were made/recorded (the <em>measurements</em>) from the variables within those observations. You also need to know something about <em>how</em> or <em>where</em> the data were collected or what they represent — this is information <em>about</em> the data, <em>i.e.</em>, some <em>meta-data</em>.</p>
<section id="pivot_longer" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="pivot_longer"><span class="header-section-number">4.1</span> <code>pivot_longer()</code></h2>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Diagnostic: When Do I Need <code>pivot_longer()</code>?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ask yourself:</p>
<ul>
<li><strong>Do my column names encode data values?</strong> (<em>e.g.</em>, “DEA”, “SAWS”)</li>
<li><strong>Is one variable split across multiple columns?</strong></li>
</ul>
<p>If yes, you likely need <code>pivot_longer()</code>.</p>
</div>
</div>
<p>The R function <code>pivot_longer()</code> is a useful tool for transforming data from wide to long format. It belongs to the <strong>tidyr</strong> package (loaded with <strong>tidyverse</strong>) and allows you to reshape your dataframe by <em>gathering</em> multiple columns into key-value pairs. Specifically, <code>pivot_longer()</code> takes in a dataframe and allows you to select a set of columns that you would like to <em>pivot</em> into longer format, while specifying the names of the key, value columns that you want to create. The resulting data frame will have a new row for each unique combination of key and value pairs. This function is particularly useful when you need to reshape your data in order to carry out certain analyses or visualisations.</p>
<p>Have a look now at <code>SACTN2</code> for an example of what <em>wide</em> data look like, and how to fix it.</p>
<p>In <code>SACTN2</code> you can see that the <code>src</code> column has been removed and that the temperatures are placed in columns that denote the collecting source. This may at first seem like a reasonable way to organise these data, but it is not tidy because the collecting source is one variable, and so should not take up more than one column (<em>i.e.</em>, there are multiple observations per row). You need to gather these source columns together into one column so that the separate measurements (observations) can conform to the one observation per row rule. You do this by telling <code>pivot_longer()</code> the names of the columns you want to squish together. You then tell it the name of the <strong>key</strong> (<code>names_to</code>) column. This is the column that will contain all of the old column names we are gathering. In this case you may call it <code>source</code>. The last piece of this puzzle is the <strong>value</strong> (<code>values_to</code>) column. This is where you decide what the name of the column will be for measurements you are gathering up. In this case you may name it <code>temperature</code>, because you are gathering up the temperature values that were incorrectly spread out by the source of the measurements.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>SACTN2_tidy <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(SACTN2, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"DEA"</span>, <span class="st">"KZNSB"</span>, <span class="st">"SAWS"</span>),</span>
<span id="cb7-2"><a href="#cb7-2"></a>                            <span class="at">names_to =</span> <span class="st">"src"</span>,</span>
<span id="cb7-3"><a href="#cb7-3"></a>                            <span class="at">values_to =</span> <span class="st">"temp"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="pivot_wider" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="pivot_wider"><span class="header-section-number">4.2</span> <code>pivot_wider()</code></h2>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Diagnostic: When Do I Need <code>pivot_wider()</code>?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ask yourself:</p>
<ul>
<li><strong>Are multiple variables stacked in one column?</strong> (<em>e.g.</em>, <code>var</code> + <code>val</code>)</li>
<li><strong>Is each observation split across multiple rows?</strong></li>
</ul>
<p>If yes, you likely need <code>pivot_wider()</code>.</p>
</div>
</div>
<p>The function <code>pivot_wider()</code> is a tool for transforming data from long to wide format. It is the counterpart to the <code>pivot_longer()</code> function. <code>pivot_wider()</code> allows you to take a set of columns containing key-value pairs and convert them into a wider format, where each unique key value becomes a separate column in the resulting data frame. You can also specify a set of value columns that you want to spread across the new columns created by the key values. With <code>pivot_wider()</code>, you can quickly transform your data from long format into a more intuitive, wide format that is easier to work with in some applications.</p>
<p>Should your data be too long for a particular application (typically a non-Tidyverse application) or your liking, meaning when individual observations are spread across multiple rows, you will need to use <code>pivot_wider()</code> to rectify the situation. This is generally the case when you have two or more variables stored within the same column, as you will see in <code>SACTN3</code>. This is not terribly common as it would require someone to put quite a bit of time into making a dataframe this way. But never say never. To spread data to become wider, you first tell R what the name of the column is that contains more than one variable, in this case the <code>var</code> column. You then tell R what the name of the column is that contains the values that need to be spread, in this case the <code>val</code> column.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>SACTN3_tidy1 <span class="ot">&lt;-</span> SACTN3 <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"var"</span>, <span class="at">values_from =</span> <span class="st">"val"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Pivot Rule of Thumb (and a Quick anti-example)
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong><code>pivot_longer()</code></strong> turns <strong>column names → values</strong>.</li>
<li><strong><code>pivot_wider()</code></strong> turns <strong>values → column names</strong>.</li>
</ul>
<p>If you use the wrong one, you either <em>explode</em> the data (too many rows) or <em>flatten</em> it (too many columns) and lose the one-observation-per-row rule.</p>
</div>
</div>
</section>
</section>
<section id="separating-and-uniting" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Separating and Uniting</h1>
<p>You have now seen how to make our dataframes longer or wider depending on their tidiness. Now you will look at how to manage our columns when they contain more (or less) than one variable, but the overall dataframe does not need to be made wider, longer. This is generally the case when one has a column with two variables or two or more variables are spread out across multiple columns, but there is still only one observation per row. Here are some examples to make this clearer.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Pattern to Recognise: Compound Variables
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>compound variable</strong> is a single column that encodes multiple facts (<em>e.g.</em>, <code>site/src</code> or <code>year-month-day</code>).</p>
<p>If you see a compound variable, you need <code>separate_*()</code> or <code>unite()</code> — but be careful: splitting can also <em>break</em> a semantic unit (dates are the classic example).</p>
</div>
</div>
<section id="separate" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="separate"><span class="header-section-number">5.1</span> Separate</h2>
<p>Looking at <code>SACTN4a</code>, you see that you no longer have a <code>site</code> and <code>src</code> column. Rather these have been replaced by an <code>index</code> column. This is an efficient way to store these data, but it is not tidy because the site and source of each observation have now been combined into one column (variable). Remember that tidy data calls for each of the things known about the data to be its own variable. To re-create <code>site</code> and <code>src</code> columns, you must <em>separate</em> the <code>index</code> column. There are two options: <code>separate_wider_delim()</code> and <code>separate_wider_position()</code>. What does each do? First you give R the name of the column you want to separate, in this case <code>index</code>. Next you specify what the names of the new columns will be. Remember that because we are creating new column names, you feed these into R within inverted commas. Lastly, you should tell R where to separate the <code>index</code> column. If you look at the data you will see that the values you want to split up are separated with <code>/</code> (including a space), so that is what you need to tell R.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>SACTN4a_tidy <span class="ot">&lt;-</span> SACTN4a <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">separate_wider_delim</span>(index, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"site"</span>, <span class="st">"src"</span>), <span class="at">delim =</span> <span class="st">"/ "</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="separating-dates-using-mutate" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="separating-dates-using-mutate"><span class="header-section-number">5.2</span> Separating Dates Using <code>mutate()</code></h2>
<p>Although the <code>date</code> column represents an example of a date <em>date type</em> or <em>class</em> (a kind of data in its own right), you might also want to split this column into its constituent parts, <em>i.e.</em>, create separate columns for day, month, and year. In this case you can spread these components of the date vector into three columns using the <code>mutate()</code> function and some functions in the <strong>lubridate</strong> package (part of the <strong>tidyverse</strong>).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>SACTN_tidy2 <span class="ot">&lt;-</span> SACTN4a <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">separate_wider_delim</span>(index, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"site"</span>, <span class="st">"src"</span>), <span class="at">delim =</span> <span class="st">"/ "</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">mutate</span>(<span class="at">day =</span> lubridate<span class="sc">::</span><span class="fu">day</span>(date),</span>
<span id="cb10-4"><a href="#cb10-4"></a>         <span class="at">month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date),</span>
<span id="cb10-5"><a href="#cb10-5"></a>         <span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Note that when the date is split into component parts the data are no longer tidy (see below).</p>
<div class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Dates Are a Semantic Unit
</div>
</div>
<div class="callout-body-container callout-body">
<p>Splitting dates can be useful for grouping, but it also violates tidy principles by scattering one concept across multiple columns. Use this tactically and re-unite when you are done.</p>
</div>
</div>
</section>
<section id="unite" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="unite"><span class="header-section-number">5.3</span> Unite</h2>
<p>It is not uncommon that field/lab instruments split values across multiple columns while they are making recordings. You might sometimes see this with date values where the year, month, and day values are given in different columns. There are uses for the data in this way, though it is not terribly tidy. You usually want the date of any observation to be shown in just one column. If you look at <code>SACTN4b</code> you will see that there is a <code>year</code>, <code>month</code>, <code>day</code> column. To <code>unite()</code> them you must first tell R what you want the united column to be labelled, in this case you will use <code>date</code>. You then list the columns to be united; here this is <code>year</code>, <code>month</code>, <code>day</code>. Lastly, decide if you want the united values to have a separator between them. The standard separator for date values is “-”.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>SACTN4b_tidy <span class="ot">&lt;-</span> SACTN4b <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">unite</span>(<span class="at">col =</span> <span class="st">"date"</span>, year, month, day, <span class="at">sep =</span> <span class="st">"-"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="joining" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Joining</h1>
<p>Now you will see the process for joining two different dataframes. Remember that one of the rules of tidy data is that only one complete dataset is saved per dataframe. This rule then is violated not only when additional data are stored where they do not belong, but also when necessary data are saved elsewhere. Looking back at <code>SACTN4a</code> and <code>SACTN4b</code>, you will see that they are each missing different columns. Were you to <code>join()</code> these dataframes together they would complete each other. The <code>tidyverse</code> provides several methods of doing this, but you will see in action the most common technique to use. The function <code>left_join()</code> is so named because it joins two or more dataframes together based on the matching of columns from the left to the right. It combines values together where it sees that they match up, and adds new rows, columns where they do not.</p>
<div class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Before You Join, Check…
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Are join keys unique</strong> on at least one side?</li>
<li><strong>Do both tables represent the same observational unit?</strong></li>
<li><strong>What should happen to unmatched rows?</strong> (keep them, drop them, or flag them)</li>
</ul>
<p>Joins can silently <em>duplicate</em> or <em>lose</em> rows. Always check counts before and after.</p>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>SACTN4_tidy <span class="ot">&lt;-</span> <span class="fu">left_join</span>(SACTN4a_tidy, SACTN4b_tidy)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>R&gt; Joining with `by = join_by(site, src, date)`</code></pre>
</div>
</div>
<p>As you see above, if you let <code>left_join()</code> do its thing it will make a plan for and find the common columns and match up the values and observations for you as best it can. It then returns a message letting you know what it has done. That is a pleasant convenience, but you most likely want to exert more control over this process than that. In order to specify the columns to be used for joining you must add one more argument to <code>left_join()</code>. The <code>by</code> argument must be fed a list of column names in inverted commas if you want to specify how to join our dataframes. Note that when you run this it does not produce a message as you have provided enough explicit information that the function is no longer needing to ‘think’ for itself.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>SACTN4_tidy <span class="ot">&lt;-</span> <span class="fu">left_join</span>(SACTN4a_tidy, SACTN4b_tidy, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"site"</span>, <span class="st">"src"</span>, <span class="st">"date"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>There are also other kinds of joins: see for example also <code>inner_join</code>, <code>right_join</code>, <code>full_join</code>, <code>semi-join</code>, <code>nest_join</code>, <code>anti_join</code> in the <strong>dplyr</strong> package contained within <strong>tidyverse</strong>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span><code>cbind()</code> and <code>rbind()</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do this now: how do the <code>*_join()</code> functions differ from <code>cbind()</code> and <code>rbind()</code>? What are the differences between these functions? What are the similarities? Provide an example of each in action.</p>
</div>
</div>
</section>
<section id="putting-it-all-together-an-analysis-ready-dataset" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Putting it All Together: An Analysis-Ready Dataset</h1>
<p>Below is a single pipeline that uses <strong>pivoting</strong>, <strong>separation</strong>, <strong>unification</strong>, and a <strong>join</strong> to create one tidy dataset (<code>SACTN_final</code>). This is the object you would keep and use for analysis. (The join against <code>SACTN4a</code> is included purely to demonstrate separation; in a real workflow you would keep one source of truth.)</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>SACTN_final <span class="ot">&lt;-</span> SACTN2 <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"DEA"</span>, <span class="st">"KZNSB"</span>, <span class="st">"SAWS"</span>),</span>
<span id="cb15-3"><a href="#cb15-3"></a>               <span class="at">names_to =</span> <span class="st">"src"</span>,</span>
<span id="cb15-4"><a href="#cb15-4"></a>               <span class="at">values_to =</span> <span class="st">"temp"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">drop_na</span>(temp) <span class="sc">|&gt;</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date)) <span class="sc">|&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="fu">select</span>(site, date, src, temp) <span class="sc">|&gt;</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="fu">left_join</span>(</span>
<span id="cb15-9"><a href="#cb15-9"></a>    SACTN4a <span class="sc">|&gt;</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>      <span class="fu">separate_wider_delim</span>(index, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"site"</span>, <span class="st">"src"</span>), <span class="at">delim =</span> <span class="st">"/ "</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>      <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date)) <span class="sc">|&gt;</span></span>
<span id="cb15-12"><a href="#cb15-12"></a>      <span class="fu">select</span>(site, src, date),</span>
<span id="cb15-13"><a href="#cb15-13"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"site"</span>, <span class="st">"src"</span>, <span class="st">"date"</span>)</span>
<span id="cb15-14"><a href="#cb15-14"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb15-15"><a href="#cb15-15"></a>  <span class="fu">left_join</span>(</span>
<span id="cb15-16"><a href="#cb15-16"></a>    SACTN4b <span class="sc">|&gt;</span></span>
<span id="cb15-17"><a href="#cb15-17"></a>      <span class="fu">unite</span>(<span class="at">col =</span> <span class="st">"date"</span>, year, month, day, <span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-18"><a href="#cb15-18"></a>      <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date)) <span class="sc">|&gt;</span></span>
<span id="cb15-19"><a href="#cb15-19"></a>      <span class="fu">select</span>(site, src, date, depth, type),</span>
<span id="cb15-20"><a href="#cb15-20"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"site"</span>, <span class="st">"src"</span>, <span class="st">"date"</span>)</span>
<span id="cb15-21"><a href="#cb15-21"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Use it immediately to see the payoff:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SACTN_final, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> temp)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour =</span> site, <span class="at">group =</span> <span class="fu">paste0</span>(site, src))) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Temperature (°C)"</span>, <span class="at">colour =</span> <span class="st">"Site"</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-tidy-final" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidy-final-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-tidy_files/figure-html/fig-tidy-final-1.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidy-final-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Analysis-ready SACTN data plotted by site and source.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="but-why-though" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> But Why Though?</h1>
<p>At this point you may be wondering what the point of all of this is. Sure it is all well and good to see how to tidy your data in R, but could not this be done more quickly, easily in MS Excel? Perhaps, yes, with a small dataset. But remember, (for many) the main reason you are learning R is to ensure that you are performing reproducible research. This means that every step in our workflow must be documented. And you accomplish this by writing R scripts, and part of the purpose of these scripts is to ensure that you capture all the steps taken to get the raw data into a neat, tidy format that can unambiguously be read into R in the format that will quickly get you up and running with your analyses and visualisations.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{a._j.2021,
  author = {A. J. , Smit},
  title = {6. {Tidy} {Data}},
  date = {2021-01-01},
  url = {http://samos-r.netlify.app/intro_r/06-tidy.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-a._j.2021" class="csl-entry quarto-appendix-citeas" role="listitem">
A. J. S (2021) 6. Tidy Data. <a href="http://samos-r.netlify.app/intro_r/06-tidy.html">http://samos-r.netlify.app/intro_r/06-tidy.html.
</a>
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("http:\/\/samos-r\.netlify\.app");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../intro_r/05-workflow.html" class="pagination-link" aria-label="5. R Workflows">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">5. R Workflows</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../intro_r/07-tidier.html" class="pagination-link" aria-label="7. Tidier Data">
        <span class="nav-page-text">7. Tidier Data</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>