<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Smit, A. J.">
<meta name="dcterms.date" content="2021-01-01">

<title>14. Tidier Data – SAMOS R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../intro_r/15-tidiest.html" rel="next">
<link href="../intro_r/13-tidy.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-21fe018c864e78632dc0e35f28f7bac9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">SAMOS R</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../intro_r/01-RStudio.html"> 
<span class="menu-text">Intro to R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../basic_stats/02-summarise-and-describe.html"> 
<span class="menu-text">Biostatistics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tasks/BCB744_Task_A.html"> 
<span class="menu-text">Tasks</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../intro_r/01-RStudio.html">Introduction to R</a></li><li class="breadcrumb-item"><a href="../intro_r/14-tidier.html">14. Tidier Data</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/SAMOS-logo-transparent.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../images/SAMOS-logo-transparent.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction to R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/01-RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/02-working-with-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Working with Data and Code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/03-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. R Markdown and Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/04-data-in-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data Classes and Structures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/05-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. R Workflows</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/06-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Graphics with <strong>ggplot2</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/07-faceting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Faceting Figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/08-brewing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Brewing Colours</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/09-mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Mapping with <strong>ggplot2</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/10-mapping_style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Mapping with Style</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/11-mapping_rnaturalearth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Mapping with Natural Earth</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/12-mapping_quakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. The Fiji Earthquake Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/13-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Tidy Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/14-tidier.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">14. Tidier Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/15-tidiest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15. Tidiest Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/16-recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16. Synthesis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/17-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17. Functions by Chapter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/18-base_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">18. Base R Primer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/19-dates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">19. Dates</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Biostatistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/02-summarise-and-describe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Data Summaries &amp; Descriptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/03-visualise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Statistical Figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/04-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/05-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Statistical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/06-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Assumptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/07-t_tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. <em>t</em>-Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/08-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/09-regressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Simple Linear Regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/10-correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/11-decision_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Parametric Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/12-glance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Non-Parametric Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/13-confidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Confidence Intervals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/14-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Data Transformations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Tasks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_A.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_B.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task B</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_C.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_D.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Bonus Task</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_E.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task E</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_F.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task F</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_G.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task G</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_H.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task G</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_Bonus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Bonus Task</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#comparison-and-logical-boolean-operators" id="toc-comparison-and-logical-boolean-operators" class="nav-link" data-scroll-target="#comparison-and-logical-boolean-operators"><span class="header-section-number">2</span> Comparison and Logical (Boolean) Operators</a></li>
  <li><a href="#arrange-observations-rows-with-arrange" id="toc-arrange-observations-rows-with-arrange" class="nav-link" data-scroll-target="#arrange-observations-rows-with-arrange"><span class="header-section-number">3</span> Arrange Observations (Rows) with <code>arrange()</code></a></li>
  <li><a href="#filter-observations-rows-with-filter" id="toc-filter-observations-rows-with-filter" class="nav-link" data-scroll-target="#filter-observations-rows-with-filter"><span class="header-section-number">4</span> Filter Observations (Rows) with <code>filter()</code></a></li>
  <li><a href="#select-variables-columns-with-select" id="toc-select-variables-columns-with-select" class="nav-link" data-scroll-target="#select-variables-columns-with-select"><span class="header-section-number">5</span> Select Variables (Columns) with <code>select()</code></a></li>
  <li><a href="#create-new-variables-columns-with-mutate" id="toc-create-new-variables-columns-with-mutate" class="nav-link" data-scroll-target="#create-new-variables-columns-with-mutate"><span class="header-section-number">6</span> Create New Variables (Columns) with <code>mutate()</code></a></li>
  <li><a href="#summarise-variables-columns-with-summarise" id="toc-summarise-variables-columns-with-summarise" class="nav-link" data-scroll-target="#summarise-variables-columns-with-summarise"><span class="header-section-number">7</span> Summarise Variables (Columns) with <code>summarise()</code></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../intro_r/01-RStudio.html">Introduction to R</a></li><li class="breadcrumb-item"><a href="../intro_r/14-tidier.html">14. Tidier Data</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">14. Tidier Data</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Smit, A. J. <a href="https://orcid.org/0000-0002-3799-6126" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://uwc.ac.za">
            University of the Western Cape
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 1, 2021</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><img src="../images/SAMOS-logo-transparent.png" class="img-fluid" style="width:35.0%"></p>
<blockquote class="blockquote">
<p>“<em>Statistics cannot rescue a poorly designed study.</em>”</p>
<p>— Douglas Altman</p>
</blockquote>
<blockquote class="blockquote">
<p>“<em>The statistician’s task is not to discover the truth, but to measure uncertainty.</em>”</p>
<p>— Bradley Efron</p>
</blockquote>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>On Day 1 already you worked through a tidy workflow. You saw how to import data, how to manipulate it, run a quick analysis, and create figures. In the previous session you filled in the missing piece of the workflow by also learning how to tidy up your data within R. For the remainder of today you will be revisiting the “transform” portion of the tidy workflow. In this session you are going to go into more depth on what you learned in Day 1, and in the last session you will learn some new tricks. Over these two sessions you will also become more comfortable with the <em>pipe</em> command <code>%&gt;%</code>, while practising writing tidy code.</p>
<p>Transformation in the tidyverse is a small grammar, not a random list of tools. All five verbs share three properties:</p>
<ol type="1">
<li>The first argument is a data frame.</li>
<li>The output is a data frame.</li>
<li>The result stays tidy unless you <em>deliberately</em> collapse it (mainly with <code>summarise()</code>).</li>
</ol>
<p>There are five primary data transformation functions that you will focus on here:</p>
<ul>
<li>Arrange observations (rows) with <code>arrange()</code><br>
</li>
<li>Filter observations (rows) with <code>filter()</code><br>
</li>
<li>Select variables (columns) with <code>select()</code><br>
</li>
<li>Create new variables (columns) with <code>mutate()</code><br>
</li>
<li>Summarise variables (columns) with <code>summarise()</code></li>
</ul>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Quick Decision Guide
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Need fewer rows?</strong> → <code>filter()</code></li>
<li><strong>Need different row order?</strong> → <code>arrange()</code></li>
<li><strong>Need fewer or re-ordered columns?</strong> → <code>select()</code></li>
<li><strong>Need new columns (same number of rows)?</strong> → <code>mutate()</code></li>
<li><strong>Need fewer rows by aggregating?</strong> → <code>summarise()</code> (usually after <code>group_by()</code>)</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Row/column Invariants
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>arrange()</code> and <code>filter()</code> change <strong>rows</strong>, not columns.</li>
<li><code>select()</code> and <code>mutate()</code> change <strong>columns</strong>, not rows.</li>
<li><code>summarise()</code> changes <strong>rows</strong> <em>on purpose</em> (it collapses data).</li>
</ul>
</div>
</div>
<p>You will use the full South African Coastal Temperature Network dataset for these exercises. Before you begin, however, you will need to cover two new concepts.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Load libraries</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># Load the data from a .RData file</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"BCB744"</span>, <span class="st">"SACTNmonthly_v4.0.RData"</span>))</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># Copy the data as a dataframe with a shorter name</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>SACTN <span class="ot">&lt;-</span> SACTNmonthly_v4<span class="fl">.0</span></span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co"># Remove the original</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">rm</span>(SACTNmonthly_v4<span class="fl">.0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Pipes as a Thinking Tool
</div>
</div>
<div class="callout-body-container callout-body">
<p>The pipe is not just syntax. Each line should answer one question: “What rows do I want?” → “What columns do I need?” → “What new columns should I add?” If a pipeline feels confusing, split it into steps and inspect the intermediate outputs.</p>
</div>
</div>
</section>
<section id="comparison-and-logical-boolean-operators" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Comparison and Logical (Boolean) Operators</h1>
<p>The assignment operator (<code>&lt;-</code>) is a symbol that we use to assign some bit of code to an object in your environment. Likewise, <strong>comparison operators</strong> are symbols we use to compare different objects. This is how you tell R how to decide to do many different things. You will see these symbols often out in the “real world” so let us spend a moment now getting to know them better. Most of these should be very familiar to you already:</p>
<ul>
<li><code>&gt;</code>: Greater than<br>
</li>
<li><code>&gt;=</code>: Greater than or equal to</li>
<li><code>&lt;</code>: Less than</li>
<li><code>&lt;=</code>: Less than or equal to</li>
<li><code>==</code>: Equal to</li>
<li><code>!=</code>: Not equal to</li>
</ul>
<p>It is important here to note that <code>==</code> is for comparisons; <code>=</code> is for maths. They are <em>not</em> interchangeable, as we may see in the following code chunk. This is one of the more common mistakes one makes when writing code. Luckily the error message this creates should provide us with the clues we need to figure out that we have made this specific mistake.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">filter</span>(<span class="at">site =</span> <span class="st">"Amanzimtoti"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<pre><code>R&gt; Error in `filter()`:
R&gt; ! We detected a named input.
R&gt; ℹ This usually means that you've used `=` instead of `==`.
R&gt; ℹ Did you mean `site == "Amanzimtoti"`?</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Why the Error Is Helpful
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>dplyr</code> inspects your arguments and refuses to guess what you meant. This is a feature: it prevents silent mistakes and makes debugging faster.</p>
</div>
</div>
<p>The comparison operators are often used together with <strong>Boolean operators</strong>. Boolean operators are used for logical operations and can compare values, resulting in either <code>TRUE</code> and <code>FALSE</code>. Here they are:</p>
<ul>
<li><code>!</code>: NOT - Negates a true value to false, and a false value to true.</li>
<li><code>&amp;</code>: AND (vectorised) - Returns <code>TRUE</code> if both operands are true, <code>FALSE</code> otherwise.</li>
<li><code>|</code>: OR (vectorised) - Returns <code>TRUE</code> if at least one of the operands is true.</li>
<li><code>&amp;&amp;</code>: AND (short-circuit) - Only evaluates the first element of each vector.</li>
<li><code>||</code>: OR (short-circuit) - Only evaluates the first element of each vector.</li>
</ul>
<p>Think of <code>&amp;</code> as <strong>constraint tightening</strong> (both conditions must be true) and <code>|</code> as <strong>constraint loosening</strong> (either condition can be true).</p>
<p>The <code>%in%</code> operator in R is a special operator used to test if elements of a vector or data object are contained in another vector or data object. It returns a Boolean vector (<code>TRUE</code> and <code>FALSE</code>) indicating whether each element of the first vector is found in the second vector. This operator is particularly useful for subsetting or filtering data based on matching values. For example, <code>x %in% y</code> will check for each element of <code>x</code> if there is a match in <code>y</code>, and return a logical vector indicating the presence or absence of each <code>x</code> element in <code>y</code>.</p>
<p>So, comparison operators are used to make direct comparisons between specific things, but logical operators are used more broadly when making logical arguments. Logic is central to most computing so it is worth taking the time to cover these symbols explicitly here. R makes use of the same <em>Boolean logic</em> symbols as many other platforms, including Google, so some (or all) of these will likely be familiar.</p>
<p>When writing a line of tidy code you tend to use these logical operator to combine two or more arguments that use comparison operators. For example, the following code chunk uses the <code>filter()</code> function to find all temperatures recorded at Pollock Beach during December <em>or</em> January. Do not worry if the following line of code is difficult to piece out, but make sure you can locate which symbols are comparison operators, which are logical operators. Please note that for purposes of brevity all of the outputs in this section are limited to ten lines but when you run these code chunks on your own computer they will be much longer.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Pollock Beach"</span>, <span class="fu">month</span>(date) <span class="sc">==</span> <span class="dv">12</span> <span class="sc">|</span> <span class="fu">month</span>(date) <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;             site  src       date     temp depth   type
R&gt; 1  Pollock Beach SAWS 1999-12-01 19.95000     0 thermo
R&gt; 2  Pollock Beach SAWS 2000-01-01 19.03333     0 thermo
R&gt; 3  Pollock Beach SAWS 2000-12-01 19.20000     0 thermo
R&gt; 4  Pollock Beach SAWS 2001-01-01 18.32667     0 thermo
R&gt; 5  Pollock Beach SAWS 2001-12-01 20.59032     0 thermo
R&gt; 6  Pollock Beach SAWS 2002-01-01 21.47097     0 thermo
R&gt; 7  Pollock Beach SAWS 2002-12-01 19.78065     0 thermo
R&gt; 8  Pollock Beach SAWS 2003-01-01 20.64516     0 thermo
R&gt; 9  Pollock Beach SAWS 2003-12-01 20.48710     0 thermo
R&gt; 10 Pollock Beach SAWS 2004-01-01 21.34839     0 thermo</code></pre>
</div>
</div>
<p>You will look at the interplay between comparison and logical operators in more depth in the following session after you have reacquainted yourself with the main transformation functions you need to know.</p>
</section>
<section id="arrange-observations-rows-with-arrange" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Arrange Observations (Rows) with <code>arrange()</code></h1>
<p>First up in our greatest hits reunion tour is the function <code>arrange()</code>. This very simply arranges the observations (rows) in a dataframe based on the variables (columns) it is given. If you are concerned with ties in the ordering of our data you provide additional columns to <code>arrange()</code>. The importance of the columns for arranging the rows is given in order from left to right.</p>
<p>When does arranging matter?</p>
<ul>
<li><strong>Checking extremes</strong> (highest/lowest values).</li>
<li><strong>Validating temporal order</strong> before plotting.</li>
<li><strong>Preparing grouped summaries</strong> so you can inspect patterns.</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">arrange</span>(depth, temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;             site  src       date      temp depth   type
R&gt; 1      Sea Point SAWS 1990-07-01  9.635484     0 thermo
R&gt; 2     Muizenberg SAWS 1984-07-01  9.708333     0 thermo
R&gt; 3     Doringbaai SAWS 2000-12-01  9.772727     0 thermo
R&gt; 4  Hondeklipbaai SAWS 2003-06-01  9.775000     0 thermo
R&gt; 5      Sea Point SAWS 1984-06-01 10.000000     0 thermo
R&gt; 6     Muizenberg SAWS 1992-07-01 10.193548     0 thermo
R&gt; 7  Hondeklipbaai SAWS 2005-07-01 10.333333     0 thermo
R&gt; 8  Hondeklipbaai SAWS 2003-07-01 10.340909     0 thermo
R&gt; 9      Sea Point SAWS 2000-12-01 10.380645     0 thermo
R&gt; 10    Muizenberg SAWS 1984-08-01 10.387097     0 thermo</code></pre>
</div>
</div>
<p>If you would rather arrange your data in descending order, as is perhaps more often the case, you simply wrap the column name you are arranging by with the <code>desc()</code> function as shown below.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(temp))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;             site   src       date     temp depth type
R&gt; 1        Sodwana   DEA 2000-02-01 28.34648    18  UTR
R&gt; 2        Sodwana   DEA 1999-03-01 28.04890    18  UTR
R&gt; 3        Sodwana   DEA 1998-03-01 27.87781    18  UTR
R&gt; 4        Sodwana   DEA 1998-02-01 27.76452    18  UTR
R&gt; 5        Sodwana   DEA 1996-02-01 27.73637    18  UTR
R&gt; 6        Sodwana   DEA 2000-03-01 27.52637    18  UTR
R&gt; 7        Sodwana   DEA 2000-01-01 27.52291    18  UTR
R&gt; 8  Leadsmanshoal EKZNW 2007-02-01 27.48132    10  UTR
R&gt; 9        Sodwana EKZNW 2005-01-01 27.45619    12  UTR
R&gt; 10       Sodwana EKZNW 2007-02-01 27.44054    12  UTR</code></pre>
</div>
</div>
<p>It must also be noted that when arranging data in this way, any rows with <code>NA</code> values will be sent to the bottom of the dataframe. This is not always ideal and so must be kept in mind.</p>
</section>
<section id="filter-observations-rows-with-filter" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Filter Observations (Rows) with <code>filter()</code></h1>
<p>When simply arranging data is not enough, and you need to remove rows of data you do not want, <code>filter()</code> is the tool to use. For example, you can select all monthly temperatures recorded at the <code>site</code> Humewood during the <code>year</code> 1990 with the following code chunk:</p>
<div class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Filtering Is Destructive
</div>
</div>
<div class="callout-body-container callout-body">
<p>Every <code>filter()</code> call removes rows. Stacking multiple filters shrinks your data quickly. If results look “too small,” check each step.</p>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Humewood"</span>, <span class="fu">year</span>(date) <span class="sc">==</span> <span class="dv">1990</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;        site  src       date     temp depth   type
R&gt; 1  Humewood SAWS 1990-01-01 21.87097     0 thermo
R&gt; 2  Humewood SAWS 1990-02-01 18.64286     0 thermo
R&gt; 3  Humewood SAWS 1990-03-01 18.61290     0 thermo
R&gt; 4  Humewood SAWS 1990-04-01 17.30000     0 thermo
R&gt; 5  Humewood SAWS 1990-05-01 16.35484     0 thermo
R&gt; 6  Humewood SAWS 1990-06-01 15.93333     0 thermo
R&gt; 7  Humewood SAWS 1990-07-01 15.70968     0 thermo
R&gt; 8  Humewood SAWS 1990-08-01 16.09677     0 thermo
R&gt; 9  Humewood SAWS 1990-09-01 16.41667     0 thermo
R&gt; 10 Humewood SAWS 1990-10-01 17.14194     0 thermo</code></pre>
</div>
</div>
<p>Remember to use the assignment operator (<code>&lt;-</code>, keyboard shortcut <strong>alt -</strong>) if you want to create an object in the environment with the new results.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>humewood_90s <span class="ot">&lt;-</span> SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Humewood"</span>, <span class="fu">year</span>(date) <span class="sc">%in%</span> <span class="fu">seq</span>(<span class="dv">1990</span>, <span class="dv">1999</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>It must be mentioned that <code>filter()</code> also automatically removes any rows in the filtering column that contain <code>NA</code> values. Should you want to keep rows that contain missing values, insert the <code>is.na()</code> function into the line of code in question. To illustrate this let us filter the temperatures for the Port Nolloth data collected by the DEA that were at or below 11°C or were missing values. You will put each argument on a separate line to help keep things clear. Note how R automatically indents the last line in this chunk to help remind you that they are in fact part of the same argument. Also note how I have put the last bracket at the end of this argument on its own line. This is not required, but I like to do so as it is a very common mistake to forget the last bracket.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Port Nolloth"</span>, <span class="co"># First give the site to filter</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>         src <span class="sc">==</span> <span class="st">"DEA"</span>, <span class="co"># Then specify the source</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>         temp <span class="sc">&lt;=</span> <span class="dv">11</span> <span class="sc">|</span> <span class="co"># Temperatures at or below 11°C OR</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>           <span class="fu">is.na</span>(temp) <span class="co"># Include missing values</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>         )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="select-variables-columns-with-select" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Select Variables (Columns) with <code>select()</code></h1>
<p>When you load a dataset that contains more columns than will be useful or required, it is preferable to shave off the excess. You do this with the <code>select()</code> function. In the following four examples you are going to remove the <code>depth</code> and <code>type</code> columns. There are many ways to do this and none are technically better or faster. So it is up to the user to find a favourite technique.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Two Mental Models for <code>select()</code>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Positive selection</strong>: “What do I want to keep?”</li>
<li><strong>Negative selection</strong>: “What do I want to remove?”</li>
</ul>
<p><code>select()</code> never changes rows. It only changes columns.</p>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Select columns individually by name</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">select</span>(site, src, date, temp)</span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co"># Select all columns between site and temp like a sequence</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb14-7"><a href="#cb14-7"></a>  <span class="fu">select</span>(site<span class="sc">:</span>temp)</span>
<span id="cb14-8"><a href="#cb14-8"></a></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co"># Select all columns except those stated individually</span></span>
<span id="cb14-10"><a href="#cb14-10"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb14-11"><a href="#cb14-11"></a>  <span class="fu">select</span>(<span class="sc">-</span>date, <span class="sc">-</span>depth)</span>
<span id="cb14-12"><a href="#cb14-12"></a></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co"># Select all columns except those within a given sequence</span></span>
<span id="cb14-14"><a href="#cb14-14"></a>  <span class="co"># Note that the '-' goes outside of a new set of brackets</span></span>
<span id="cb14-15"><a href="#cb14-15"></a>  <span class="co"># that are wrapped around the sequence of columns to remove</span></span>
<span id="cb14-16"><a href="#cb14-16"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb14-17"><a href="#cb14-17"></a>  <span class="fu">select</span>(<span class="sc">-</span>(date<span class="sc">:</span>depth))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>You may also use <code>select()</code> to reorder the columns in a dataframe. In this case the inclusion of the <code>everything()</code> function may be a useful shortcut as illustrated below.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Change up order by specifying individual columns</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">select</span>(temp, src, date, site)</span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co"># Use the everything function to grab all columns </span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co"># not already specified</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="fu">select</span>(type, src, <span class="fu">everything</span>())</span>
<span id="cb15-9"><a href="#cb15-9"></a></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co"># Or go bananas and use all of the rules at once</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>  <span class="co"># Remember, when dealing with tidy data,</span></span>
<span id="cb15-12"><a href="#cb15-12"></a>  <span class="co"># everything may be interchanged</span></span>
<span id="cb15-13"><a href="#cb15-13"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb15-14"><a href="#cb15-14"></a>  <span class="fu">select</span>(temp<span class="sc">:</span>type, <span class="fu">everything</span>(), <span class="sc">-</span>src)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>The Square Bracket <code>[]</code> Notation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The square bracket <code>[]</code> notation may also be used for indexing and subsetting data structures such as vectors, matrices, data frames, and lists. Before <strong>tidyverse</strong> existed, this was the only way to do so. Square brackets allow you to select elements from these data structures based on their positions, conditions, or names. The use of square brackets can vary slightly depending on the data structure being accessed. Here is a brief overview:</p>
<ol type="1">
<li><p><strong>Vectors</strong>: When used with vectors, square brackets allow you to select elements by their numeric position, a logical vector indicating which elements to select. For example<code>vector[c(1, 3)]</code> returns the first and third elements of the vector.</p></li>
<li><p><strong>Matrices</strong>: For matrices, square brackets take two dimensions <code>[row, column]</code> to select elements. You can select entire rows, columns, or individual elements. Specifying a row, column as empty (<em>e.g.</em>, <code>[,]</code>) selects everything in that dimension.</p></li>
<li><p><strong>Dataframes</strong>: Similar to matrices, square brackets can be used to subset data frames by row, column. However and since dataframes can have column names, you can also use these names for selection, <em>e.g.</em>, <code>df[1,]</code> selects the first row of the dataframe, <code>df[, "columnName"]</code> selects all rows of a specific column.</p></li>
<li><p><strong>Lists</strong>: Lists can be subsetted by numeric or character indices corresponding to their elements. For example, <code>list[[1]]</code> selects the first element of the list. Note the double brackets, which are used to extract elements from a list directly. Single brackets, <em>e.g.</em>, <code>list[1]</code>, return a sublist containing the first element.</p></li>
</ol>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Base R vs Tidyverse
</div>
</div>
<div class="callout-body-container callout-body">
<p>Base R subsetting is powerful but low-level. Tidyverse verbs are higher-level: they make your intent explicit and read like a sentence. Use the one that makes your reasoning clearest.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Data Structures and Square Brackets
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do this now: provide examples of i) the various data structures available in R, and ii) how to use square brackets to subset each of them. You may use any of the built-in datasets to do so.</p>
</div>
</div>
</section>
<section id="create-new-variables-columns-with-mutate" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Create New Variables (Columns) with <code>mutate()</code></h1>
<p>When you are performing data analysis/statistics in R this is likely because it is necessary to create some new values that did not exist in the raw data. The previous three functions you looked at (<code>arrange()</code>, <code>filter()</code>, <code>select()</code>) will prepare you to create new data, but do not do so themselves. This is when you need to use <code>mutate()</code>. You must however be very mindful that <code>mutate()</code> is only useful if we want to create new variables (columns) that are a function of one or more <em>existing</em> columns (well, that is how it is mainly used). Any new column you create with <code>mutate()</code> must always have the same number of rows as the dataframe you are working with. In order to create a new column you must first tell R what the name of the column will be, in this case let us create a column named <code>kelvin</code>. The second step is to then tell R what to put in the new column. As you may have guessed, you are going to convert the <code>temp</code> column which contains degrees Celsius (C) into Kelvin (K) by adding 273.15 to every row.</p>
<div class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Common Mutate Mistakes
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Trying to create a <em>summary</em> (fewer rows) inside <code>mutate()</code> → use <code>summarise()</code> instead.</li>
<li>Accidentally <strong>overwriting</strong> an existing column when you meant to create a new one.</li>
</ul>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">mutate</span>(<span class="at">kelvin =</span> temp <span class="sc">+</span> <span class="fl">273.15</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;            site src       date     temp depth type   kelvin
R&gt; 1  Port Nolloth DEA 1991-02-01 11.47029     5  UTR 284.6203
R&gt; 2  Port Nolloth DEA 1991-03-01 11.99409     5  UTR 285.1441
R&gt; 3  Port Nolloth DEA 1991-04-01 11.95556     5  UTR 285.1056
R&gt; 4  Port Nolloth DEA 1991-05-01 11.86183     5  UTR 285.0118
R&gt; 5  Port Nolloth DEA 1991-06-01 12.20722     5  UTR 285.3572
R&gt; 6  Port Nolloth DEA 1991-07-01 12.53810     5  UTR 285.6881
R&gt; 7  Port Nolloth DEA 1991-08-01 11.25202     5  UTR 284.4020
R&gt; 8  Port Nolloth DEA 1991-09-01 11.29208     5  UTR 284.4421
R&gt; 9  Port Nolloth DEA 1991-10-01 11.37661     5  UTR 284.5266
R&gt; 10 Port Nolloth DEA 1991-11-01 10.98208     5  UTR 284.1321</code></pre>
</div>
</div>
<p>This is a very basic example; <code>mutate()</code> is capable of much more than simple addition. You will get into some more exciting examples during the next session.</p>
</section>
<section id="summarise-variables-columns-with-summarise" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Summarise Variables (Columns) with <code>summarise()</code></h1>
<p>Finally this brings you to the last tool for this section. To create new columns you use <code>mutate()</code>, but to calculate any sort of summary/statistic from a column that will return fewer rows than the dataframe has you will use <code>summarise()</code>. This makes <code>summarise()</code> much more powerful than the other functions in this section, but because it is able to do more, it can also be more unpredictable, making its use potentially more challenging. You will almost always end up using this function in our workflows. The following chunk very simply calculates the overall mean temperature for the entire SACTN.</p>
<p>Think of <code>summarise()</code> as a <strong>controlled rupture</strong>: it intentionally breaks the one-observation-per-row structure to produce aggregate values. This is why it is almost always paired with <code>group_by()</code> later.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">summarise</span>(<span class="at">mean_temp =</span> <span class="fu">mean</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;   mean_temp
R&gt; 1  19.26955</code></pre>
</div>
</div>
<p>Note how the above chunk created a new dataframe. This is done because it cannot add this one result to the previous dataframe due to the mismatch in the number of rows. If you were to create additional columns with other summaries, you may do so within the same <code>summarise()</code> function. These multiple summaries are displayed on individual lines in the following chunk to help keep things clear.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>SACTN <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">summarise</span>(<span class="at">mean_temp =</span> <span class="fu">mean</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-3"><a href="#cb20-3"></a>            <span class="at">sd_temp =</span> <span class="fu">sd</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-4"><a href="#cb20-4"></a>            <span class="at">min_temp =</span> <span class="fu">min</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-5"><a href="#cb20-5"></a>            <span class="at">max_temp =</span> <span class="fu">max</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-6"><a href="#cb20-6"></a>            )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;   mean_temp  sd_temp min_temp max_temp
R&gt; 1  19.26955 3.682122 9.136322 28.34648</code></pre>
</div>
</div>
<p>Creating summaries of the <em>entire</em> SACTN dataset in this way is not appropriate as you should not be combining time series from such different parts of the coast. In order to calculate summaries within variables you will need to learn how to use <code>group_by()</code>, which in turn will first require you to learn how to chain multiple functions together within a pipe (<code>%&gt;%</code>). That is how you will begin the next session for today. You will finish with several tips on how to make your data the tidiest that it may be.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Debugging Pipelines
</div>
</div>
<div class="callout-body-container callout-body">
<p>If a result looks wrong:</p>
<ul>
<li>Run the pipeline stepwise and inspect intermediate objects.</li>
<li>Check row counts before and after each verb.</li>
<li>Use <code>count()</code> or <code>summarise(n = n())</code> to confirm expectations.</li>
</ul>
</div>
</div>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{a._j.2021,
  author = {A. J. , Smit},
  title = {14. {Tidier} {Data}},
  date = {2021-01-01},
  url = {http://samos-r.netlify.app/intro_r/14-tidier.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-a._j.2021" class="csl-entry quarto-appendix-citeas" role="listitem">
A. J. S (2021) 14. Tidier Data. <a href="http://samos-r.netlify.app/intro_r/14-tidier.html">http://samos-r.netlify.app/intro_r/14-tidier.html.
</a>
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("http:\/\/samos-r\.netlify\.app");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../intro_r/13-tidy.html" class="pagination-link" aria-label="13. Tidy Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">13. Tidy Data</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../intro_r/15-tidiest.html" class="pagination-link" aria-label="15. Tidiest Data">
        <span class="nav-page-text">15. Tidiest Data</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>