<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Smit, A. J.">
<meta name="dcterms.date" content="2021-01-01">

<title>7. t-Tests – SAMOS R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../basic_stats/08-anova.html" rel="next">
<link href="../basic_stats/06-assumptions.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-21fe018c864e78632dc0e35f28f7bac9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">SAMOS R</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../intro_r/01-RStudio.html"> 
<span class="menu-text">Intro to R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../basic_stats/02-summarise-and-describe.html"> 
<span class="menu-text">Biostatistics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tasks/BCB744_Task_A.html"> 
<span class="menu-text">Tasks</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../basic_stats/02-summarise-and-describe.html">Biostatistics</a></li><li class="breadcrumb-item"><a href="../basic_stats/07-t_tests.html">7. <em>t</em>-Tests</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/SAMOS-logo-transparent.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../images/SAMOS-logo-transparent.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction to R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/01-RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/02-working-with-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Working with Data and Code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/03-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. R Markdown and Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/04-data-in-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data Classes and Structures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/05-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. R Workflows</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/13-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Tidy Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/14-tidier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Tidier Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/15-tidiest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Tidiest Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/06-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Graphics with <strong>ggplot2</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/07-faceting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Faceting Figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/08-brewing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Brewing Colours</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/09-mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Mapping with <strong>ggplot2</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/10-mapping_style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Mapping with Style</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/11-mapping_rnaturalearth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Mapping with Natural Earth</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/12-mapping_quakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15. The Fiji Earthquake Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/16-recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16. Synthesis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/17-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17. Functions by Chapter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/18-base_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">18. Base R Primer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/19-dates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">19. Dates</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Biostatistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/02-summarise-and-describe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Data Summaries &amp; Descriptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/03-visualise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Statistical Figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/04-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/05-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Statistical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/06-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Assumptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/07-t_tests.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">7. <em>t</em>-Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/08-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/09-regressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Simple Linear Regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/10-correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/11-decision_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Parametric Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/12-glance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Non-Parametric Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/13-confidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Confidence Intervals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/14-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Data Transformations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Tasks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_A.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_B.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task B</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_C.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_D.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task D</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_E.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task E</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_F.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task F</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_G.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task G</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_H.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task G</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_Bonus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Bonus Task</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#at-a-glance" id="toc-at-a-glance" class="nav-link active" data-scroll-target="#at-a-glance"><span class="header-section-number">1</span> At a Glance</a></li>
  <li><a href="#introduction-to-t-tests" id="toc-introduction-to-t-tests" class="nav-link" data-scroll-target="#introduction-to-t-tests"><span class="header-section-number">2</span> Introduction to <em>t</em>-tests</a></li>
  <li><a href="#one-sample-t-tests" id="toc-one-sample-t-tests" class="nav-link" data-scroll-target="#one-sample-t-tests"><span class="header-section-number">3</span> One-sample <em>t</em>-tests</a>
  <ul class="collapse">
  <li><a href="#two-sided-one-sample-t-test" id="toc-two-sided-one-sample-t-test" class="nav-link" data-scroll-target="#two-sided-one-sample-t-test"><span class="header-section-number">3.1</span> Two-sided One-sample <em>t</em>-test</a></li>
  <li><a href="#one-sided-one-sample-t-tests" id="toc-one-sided-one-sample-t-tests" class="nav-link" data-scroll-target="#one-sided-one-sample-t-tests"><span class="header-section-number">3.2</span> One-sided One-sample <em>t</em>-tests</a></li>
  </ul></li>
  <li><a href="#two-sample-t-tests" id="toc-two-sample-t-tests" class="nav-link" data-scroll-target="#two-sample-t-tests"><span class="header-section-number">4</span> Two-sample <em>t</em>-tests</a>
  <ul class="collapse">
  <li><a href="#two-sided-two-sample-t-test" id="toc-two-sided-two-sample-t-test" class="nav-link" data-scroll-target="#two-sided-two-sample-t-test"><span class="header-section-number">4.1</span> Two-sided Two-sample <em>t</em>-test</a></li>
  <li><a href="#one-sided-two-sample-t-test" id="toc-one-sided-two-sample-t-test" class="nav-link" data-scroll-target="#one-sided-two-sample-t-test"><span class="header-section-number">4.2</span> One-sided Two-sample <em>t</em>-test</a></li>
  </ul></li>
  <li><a href="#paired-t-tests" id="toc-paired-t-tests" class="nav-link" data-scroll-target="#paired-t-tests"><span class="header-section-number">5</span> Paired <em>t</em>-tests</a></li>
  <li><a href="#is-there-a-difference-between-two-proportions" id="toc-is-there-a-difference-between-two-proportions" class="nav-link" data-scroll-target="#is-there-a-difference-between-two-proportions"><span class="header-section-number">6</span> Is There a Difference Between Two Proportions?</a>
  <ul class="collapse">
  <li><a href="#one-sample-and-two-sample-tests" id="toc-one-sample-and-two-sample-tests" class="nav-link" data-scroll-target="#one-sample-and-two-sample-tests"><span class="header-section-number">6.1</span> One-sample and Two-sample Tests</a></li>
  <li><a href="#one-sided-and-two-sided-tests" id="toc-one-sided-and-two-sided-tests" class="nav-link" data-scroll-target="#one-sided-and-two-sided-tests"><span class="header-section-number">6.2</span> One-sided and Two-sided Tests</a></li>
  </ul></li>
  <li><a href="#a-t-test-workflow" id="toc-a-t-test-workflow" class="nav-link" data-scroll-target="#a-t-test-workflow"><span class="header-section-number">7</span> A <em>t</em>-test Workflow</a>
  <ul class="collapse">
  <li><a href="#loading-data" id="toc-loading-data" class="nav-link" data-scroll-target="#loading-data"><span class="header-section-number">7.1</span> Loading Data</a></li>
  <li><a href="#visualising-data" id="toc-visualising-data" class="nav-link" data-scroll-target="#visualising-data"><span class="header-section-number">7.2</span> Visualising Data</a></li>
  <li><a href="#formulating-a-hypothesis" id="toc-formulating-a-hypothesis" class="nav-link" data-scroll-target="#formulating-a-hypothesis"><span class="header-section-number">7.3</span> Formulating a Hypothesis</a></li>
  <li><a href="#choosing-a-test" id="toc-choosing-a-test" class="nav-link" data-scroll-target="#choosing-a-test"><span class="header-section-number">7.4</span> Choosing a Test</a></li>
  <li><a href="#checking-assumptions" id="toc-checking-assumptions" class="nav-link" data-scroll-target="#checking-assumptions"><span class="header-section-number">7.5</span> Checking Assumptions</a></li>
  <li><a href="#running-an-analysis" id="toc-running-an-analysis" class="nav-link" data-scroll-target="#running-an-analysis"><span class="header-section-number">7.6</span> Running an Analysis</a></li>
  <li><a href="#interpreting-the-results" id="toc-interpreting-the-results" class="nav-link" data-scroll-target="#interpreting-the-results"><span class="header-section-number">7.7</span> Interpreting the Results</a></li>
  <li><a href="#drawing-conclusions" id="toc-drawing-conclusions" class="nav-link" data-scroll-target="#drawing-conclusions"><span class="header-section-number">7.8</span> Drawing Conclusions</a></li>
  <li><a href="#going-further" id="toc-going-further" class="nav-link" data-scroll-target="#going-further"><span class="header-section-number">7.9</span> Going Further</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">8</span> Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../basic_stats/02-summarise-and-describe.html">Biostatistics</a></li><li class="breadcrumb-item"><a href="../basic_stats/07-t_tests.html">7. <em>t</em>-Tests</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">7. <em>t</em>-Tests</h1>
<p class="subtitle lead">Comparing the Means of Two Groups</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Smit, A. J. <a href="https://orcid.org/0000-0002-3799-6126" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://uwc.ac.za">
            University of the Western Cape
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 1, 2021</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><img src="../images/SAMOS-logo-transparent.png" class="img-fluid" style="width:35.0%"></p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>In This Chapter
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>One-sample <em>t</em>-tests</li>
<li>Two-sample s <em>t</em>-tests</li>
<li>Paired <em>t</em>-tests</li>
<li>Comparison of proportions</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Required Reading
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>My book chapter on <a href="../../docs/AJ Smit - Biostatistics--The-Book - One-sample Hypotheses.pdf">one sample hypotheses</a> (DRAFT).</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Tasks to Complete in This Chapter
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Task F</li>
</ul>
</div>
</div>
<section id="at-a-glance" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> At a Glance</h1>
<p>Student’s <em>t</em>-tests are used to compare the <em>means of two groups</em> to determine if there is a significant difference between them. These are the expectations about your data:</p>
<ul>
<li><p><strong>Continuous dependent variable</strong> The dependent variable should be measured on a <em>continuous scale</em> (<em>e.g.</em>, height, mass, concentration).</p></li>
<li><p><strong>Categorical independent variable</strong> The independent variable has two independent groups being compared, so we expect a <em>factor variable with two groups</em> (<em>e.g.</em> fertiliser levels of high, low and vegetation types of grassland and forest, herbivory levels of moderate, intense). There are two types of <em>t</em>-tests depending on whether the samples are independent or paired (related):</p>
<ul>
<li><strong>Independent sample <em>t</em>-test</strong> Appropriate when the groups consist of different individuals or observations; here, the observations within one group does not affect the other group’s observations.</li>
<li><strong>Paired sample <em>t</em>-test</strong>: Appropriate when the groups are related, such as before-and-after measurements, matched pairs of individuals.</li>
</ul></li>
</ul>
<p>Other assumptions to be aware of with regards to the dependent variable:</p>
<ul>
<li><p><strong><a href="06-assumptions.html#tests-for-normality">Normal distribution</a></strong> The data in each group should follow a normal distribution or be approximately normally distributed for you to use the Student’s <em>t</em>-test, <code>t.test()</code>. If the assumption of normality is not met, as, for example, determined with the <code>shapiro.test()</code>, you may consider using a non-parametric alternative such as the Wilcoxon signed-rank test, <code>wilcox.test()</code>, as a replacement for a one-sample <em>t</em>-test or the Mann-Whitney test, also with <code>wilcox.test()</code> (but note how to set the function arguments), in stead of a two-sample <em>t</em>-test. This assumption can be relaxed for large sample sizes due to the <a href="../basic_stats/04-distributions.html#sec-normal">Central Limit Theorem</a>.</p></li>
<li><p><strong><a href="../basic_stats/06-assumptions.html#sec-homogeneity">Homoscedasticity</a></strong> The variances of the two groups should be approximately equal, as determined with the Levene’s test <code>leveneTest()</code>. If this assumption is not met, you can use Welch’s <em>t</em>-test in stead of Student’s <em>t</em>-test, as the former does not require variances to be equal. The default setting for <code>t.test()</code> is actually Welch’s <em>t</em>-test; to perform a Student’s <em>t</em>-test (one- or two-sample <em>t</em>-test) you need to set the argument <code>var.equal = TRUE</code>.</p></li>
<li><p><strong>Random sampling</strong> The data should be obtained through random sampling or random assignment, ensuring that each observation has an equal chance of being included in the sample.</p></li>
</ul>
</section>
<section id="introduction-to-t-tests" class="level1 page-columns page-full" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Introduction to <em>t</em>-tests</h1>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Do This Now!
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Task F.1.</strong> Work with two friends and devise a real ‘experiment’ (or designed sampling to determine some real-world phenomenon, more likely) in which you demonstrate the following two principles:</p>
<ol type="a">
<li>the effect of sample size on the estimate of the mean and variance (use SD),</li>
<li>the effect of repeated sampling on the value of the mean and variance. In both cases, apply the correct <em>t</em>-test (later in this Chapter) to test whether sample size, repeat sampling has a statistically significant effect. What conclusion do you reach?</li>
</ol>
<p>Report back comprehensively in Task F.</p>
</div>
</div>
<p>The simplest experiment that makes any scientific sense is one where data are collected to represent two groups — maybe a treatment compared to a control. For example, “does adding manure to some plants have a measurable effect on their growth compared to the situation where nothing was added that might affect the plants’ growth?” To answer this very basic question one often uses a <strong><em>t</em>-test</strong>.</p>
<p>The most commonly used <em>t</em>-test is <strong>Student’s <em>t</em>-test</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, a statistical hypothesis test used to determine whether two samples of data are significantly different from each other. It was introduced by William Gosset, who wrote under the pseudonym ‘Student,’ in 1908. This is a parametric test, and as already indicated, it assumes the data are normally distributed, that the variances of the two samples being compared are equal.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Whereas the Student’s <em>t</em>-test applies to data whose variances are equal among the two groups, the <strong>Welch’s <em>t</em>-test</strong> is used when the variances are unequal. The Welch’s <em>t</em>-test is a more robust test, is preferred when the sample sizes are unequal or the variances are unequal. The Welch’s <em>t</em>-test is the default setting in the<code>t.test()</code> function in R (through the argument <code>var.equal = FALSE</code>, which is the default).</p></div></div><p>Now it becomes interesting. There are several flavours of <em>t</em>-tests, depending on the nature of our samples, the type of question being asked but all of them involve comparing two samples. Specifically, <em>the comparison involves the sample means</em>, and as such, they test whether, not the central tendencies of two samples differ. Here are the variations:</p>
<ul>
<li><p><strong>One-sample <em>t</em>-tests:</strong> only one sample set of data that we wish to compare against a known population mean:</p>
<ul>
<li>one-sided one-sample <em>t</em>-tests</li>
<li>two-sided one-sample <em>t</em>-tests</li>
</ul></li>
<li><p><strong>Two-sample (or independent sample) <em>t</em>-tests:</strong> the means of two groups are compared against each other:</p>
<ul>
<li>one-sided two-sample <em>t</em>-tests</li>
<li>two-sided two-sample <em>t</em>-tests</li>
</ul></li>
<li><p><strong>Paired sample <em>t</em>-tests:</strong> two samples that are ‘matched’ or as the name indicates, <em>paired</em>, <em>i.e.</em> they are not independent of one another:</p>
<ul>
<li>one-sided</li>
<li>two-sided</li>
</ul></li>
</ul>
<p>Let us go into detail into each of these variations of <em>t</em>-tests.</p>
</section>
<section id="one-sample-t-tests" class="level1 page-columns page-full" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> One-sample <em>t</em>-tests</h1>
<section id="two-sided-one-sample-t-test" class="level2 page-columns page-full" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="two-sided-one-sample-t-test"><span class="header-section-number">3.1</span> Two-sided One-sample <em>t</em>-test</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Hypothesis for Two-sided One-sample <em>t</em>-test
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(H_{0}: \bar{x} = \mu_{0}\)</span><span class="math inline">\(H_{a}: \bar{x} \ne \mu_{0}\)</span></p>
<p>This is the same as:</p>
<p><span class="math inline">\(H_{0}: \bar{x} - \mu_{0} = 0\)</span><span class="math inline">\(H_{a}: \bar{x} - \mu_{0} \ne 0\)</span></p>
<p>Here <span class="math inline">\(\bar{x}\)</span> is the population mean<span class="math inline">\(\mu_{0}\)</span> the hypothesised mean to which <span class="math inline">\(\bar{x}\)</span> is being compared. In this example we have a two-sided one-sample <em>t</em>-test.</p>
<p>As stated above, <span class="math inline">\(H_{0}\)</span> does not make a distinction between whether it expects <span class="math inline">\(\bar{x}\)</span> to be <span class="math inline">\(\lt\)</span><span class="math inline">\(\gt\)</span> <span class="math inline">\(\mu_{0}\)</span>.</p>
</div>
</div>
<p>Generally when we use a <em>t</em>-test it will be a two-sample <em>t</em>-test (see below). Occasionally, however, we may have only one set of observations (random samples taken to represent a population) whose mean, <span class="math inline">\(\bar{x}\)</span>, we wish to compare against a known population mean, <span class="math inline">\(\mu_{0}\)</span>, which had been established <em>a priori</em> (<a href="#eq-onesample" class="quarto-xref">Equation&nbsp;1</a>). In R’s <code>t.test()</code> function, the default setting is for a <strong>two-sided one-sample <em>t</em>-test</strong> — that is, <em>we do not care if our</em> <span class="math inline">\(H_{a}\)</span> <em>is significantly less than</em> <span class="math inline">\(\mu_{0}\)</span> <em>or if it is significantly greater than</em> <span class="math inline">\(\mu_{0}\)</span>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>The one-sample <em>t</em>-test:</strong></p>
<p><span id="eq-onesample"><span class="math display">\[t = \frac{\overline{x} - \mu}{s / \sqrt{n}} \tag{1}\]</span></span></p>
<p>where <span class="math inline">\(t\)</span> is the calculated <span class="math inline">\(t\)</span>-value, <span class="math inline">\(\overline{x}\)</span> is the sample mean, <span class="math inline">\(\mu\)</span> is the hypothesised population mean, <span class="math inline">\(s\)</span> is the sample standard deviation,<span class="math inline">\(n\)</span> the sample size.</p>
</div></div><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># create a single sample of random normal data</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">set.seed</span>(<span class="dv">666</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>r_one <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">dat =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb1-4"><a href="#cb1-4"></a>                    <span class="at">sample =</span> <span class="st">"A"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<!-- ```{r} -->
<!-- ## check normality -->
<!-- shapiro.test(r_one$dat) -->
<!-- ``` -->
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># compare random data against a population mean of 20</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">t.test</span>(r_one<span class="sc">$</span>dat, <span class="at">mu =</span> <span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  One Sample t-test
R&gt; 
R&gt; data:  r_one$dat
R&gt; t = 0.0048653, df = 19, p-value = 0.9962
R&gt; alternative hypothesis: true mean is not equal to 20
R&gt; 95 percent confidence interval:
R&gt;  16.91306 23.10133
R&gt; sample estimates:
R&gt; mean of x 
R&gt;  20.00719</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># compare random data against a population mean of 30</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">t.test</span>(r_one<span class="sc">$</span>dat, <span class="at">mu =</span> <span class="dv">30</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  One Sample t-test
R&gt; 
R&gt; data:  r_one$dat
R&gt; t = -6.7596, df = 19, p-value = 1.858e-06
R&gt; alternative hypothesis: true mean is not equal to 30
R&gt; 95 percent confidence interval:
R&gt;  16.91306 23.10133
R&gt; sample estimates:
R&gt; mean of x 
R&gt;  20.00719</code></pre>
</div>
</div>
<p>What do the results of these two different tests show? Let us visualise these data to get a better understanding (<a href="#fig-boxplot1" class="quarto-xref">Figure&nbsp;1</a>).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> r_one, <span class="fu">aes</span>(<span class="at">y =</span> dat, <span class="at">x =</span> sample)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"indianred"</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-3"><a href="#cb6-3"></a>               <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="co"># population  mean (mu) = 20</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">20</span>, <span class="at">colour =</span> <span class="st">"dodgerblue2"</span>, </span>
<span id="cb6-6"><a href="#cb6-6"></a>             <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="co"># population  mean (mu) = 30</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">30</span>, <span class="at">colour =</span> <span class="st">"indianred2"</span>, </span>
<span id="cb6-9"><a href="#cb6-9"></a>             <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Value"</span>, <span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="fu">theme_pubclean</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-boxplot1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-t_tests_files/figure-html/fig-boxplot1-1.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Boxplot of random normal data with. A hypothetical population mean of 20 is shown as a blue line, with the red line showing a mean of 30.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The boxplot shows the distribution of our random data against two potential population means. Does this help now to illustrate the results of our one-sample <em>t</em>-tests?</p>
</section>
<section id="one-sided-one-sample-t-tests" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="one-sided-one-sample-t-tests"><span class="header-section-number">3.2</span> One-sided One-sample <em>t</em>-tests</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Hypothesis for One-sided One-sample <em>t</em>-test
</div>
</div>
<div class="callout-body-container callout-body">
<p>For example, when we are concerned that our sample mean, <span class="math inline">\(\bar{x}\)</span>, should be less than the <em>a priori</em> established value, <span class="math inline">\(\mu_{0}\)</span>:</p>
<p><span class="math inline">\(H_{0}: \bar{x} \ge \mu_{0}\)</span><span class="math inline">\(H_{a}: \bar{x} \lt \mu_{0}\)</span></p>
<p>Only one of the two options is shown.</p>
</div>
</div>
<p>Remember that a normal distribution has two tails. As indicated already, when we are testing for significance we are generally looking for a result that sits in the far end of either of these tails. Occasionally, however, we may want to know if the result is specifically in one of the two tails. Explicitly the leading, trailing tail. For example, is the mean value of our sample population, <span class="math inline">\(\bar{x}\)</span>, <em>significantly greater than the value</em> <span class="math inline">\(\mu_{0}\)</span>? <em>Or, is</em> <span class="math inline">\(\bar{x}\)</span> <em>less than the value</em> <span class="math inline">\(\mu_{0}\)</span>? This <em>t</em>-test is called a <strong>one-sided one-sample <em>t</em>-tests</strong>. To specify this in R we must add an argument as seen below:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># check against the trailing tail</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">t.test</span>(r_one<span class="sc">$</span>dat, <span class="at">mu =</span> <span class="dv">30</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  One Sample t-test
R&gt; 
R&gt; data:  r_one$dat
R&gt; t = -6.7596, df = 19, p-value = 9.292e-07
R&gt; alternative hypothesis: true mean is less than 30
R&gt; 95 percent confidence interval:
R&gt;      -Inf 22.56339
R&gt; sample estimates:
R&gt; mean of x 
R&gt;  20.00719</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># check against the leading tail</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">t.test</span>(r_one<span class="sc">$</span>dat, <span class="at">mu =</span> <span class="dv">30</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  One Sample t-test
R&gt; 
R&gt; data:  r_one$dat
R&gt; t = -6.7596, df = 19, p-value = 1
R&gt; alternative hypothesis: true mean is greater than 30
R&gt; 95 percent confidence interval:
R&gt;  17.451    Inf
R&gt; sample estimates:
R&gt; mean of x 
R&gt;  20.00719</code></pre>
</div>
</div>
<p>Are these the results we would have expected? Why does the second test not return a significant result?</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Do This Now!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create a visualisation to graphically demonstrate the outcome of this <em>t</em>-test.</p>
</div>
</div>
</section>
</section>
<section id="two-sample-t-tests" class="level1 page-columns page-full" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Two-sample <em>t</em>-tests</h1>
<section id="two-sided-two-sample-t-test" class="level2 page-columns page-full" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="two-sided-two-sample-t-test"><span class="header-section-number">4.1</span> Two-sided Two-sample <em>t</em>-test</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Hypothesis for Two-sided Two-sample <em>t</em>-test
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(H_{0}: \bar{A} = \bar{B}\)</span><span class="math inline">\(H_{a}: \bar{A} \ne \bar{B}\)</span></p>
<p>where <span class="math inline">\(\bar{A}\)</span> is the population mean of the first sample<span class="math inline">\(\bar{B}\)</span> the population mean of the second sample. In this example we have a two-sided two-sample <em>t</em>-test, which is the default in R’s <code>t.test()</code> function.</p>
<p>As stated above, <span class="math inline">\(H_{0}\)</span> does not make a distinction between whether it expects the difference between <span class="math inline">\(\bar{A}\)</span><span class="math inline">\(\bar{B}\)</span> to be greater than or less than 0.</p>
</div>
</div>
<p>A two-sample <em>t</em>-test is used when we have samples from two different (independent) populations whose means, <span class="math inline">\(\bar{A}\)</span><span class="math inline">\(\bar{B}\)</span>, we would like to compare against one another. Sometimes it is called an independent sample <em>t</em>-test. Specifically, it tests whether the <em>difference between the means of two samples is zero</em>. Note that again <em>we make no distinction between whether it is more interesting that the difference is greater than zero, less zero</em> — as long as there is a difference between<span class="math inline">\(\bar{A}\)</span><span class="math inline">\(\bar{B}\)</span>. This test is called a <strong>two-sided two sample <em>t</em>-test</strong> and it is the most common use of a <em>t</em>-test.</p>
<p>There are two varieties of <em>t</em>-tests. In the case of samples whose variances do not differ, we perform a <strong>Student’s <em>t</em>-test</strong>. <a href="#eq-tstat" class="quarto-xref">Equation&nbsp;2</a> shows how to calculate the <em>t</em>-statistic for Student’s <em>t</em>-test. The other case is if we have unequal variances in <span class="math inline">\(\bar{A}\)</span><span class="math inline">\(\bar{B}\)</span> (established with the Levene’s test for equality of variances; see <a href="../basic_stats/06-assumptions.html#sec-homogeneity">Chapter 6</a>); here, we perform <strong>Welch’s <em>t</em>-test</strong> as written in <a href="#eq-welch" class="quarto-xref">Equation&nbsp;4</a>. Welch’s <em>t</em>-test is the default in R’s <code>t.test()</code> function.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Student’s <em>t</em>-test:</strong> <span id="eq-tstat"><span class="math display">\[t=\frac{\bar{A}-\bar{B}}{\sqrt{\frac{S^{2}}{n}+\frac{S^{2}}{m}}} \tag{2}\]</span></span></p>
<p><span class="math inline">\(\bar{A}\)</span><span class="math inline">\(\bar{B}\)</span> are the means for groups <span class="math inline">\(A\)</span><span class="math inline">\(B\)</span>, respectively; <span class="math inline">\(n\)</span><span class="math inline">\(m\)</span> are the sample sizes of the two sets of samples, respectively;<span class="math inline">\(S^{2}\)</span> is the pooled variance, which is calculated as per <a href="#eq-pooledvar" class="quarto-xref">Equation&nbsp;3</a>:</p>
<p><span id="eq-pooledvar"><span class="math display">\[S^{2}=\frac{(n-1)S_{A}^{2}+(m-1)S_{B}^{2} }{n+m-2} \tag{3}\]</span></span></p>
<p>The degrees of freedom, <em>d.f.</em>, in the equation for the shared variance is <span class="math inline">\(n_{A}+m_{B}-2\)</span>.</p>
</div><div class="">
<p><strong>Welch’s <em>t</em>-test:</strong> <span id="eq-welch"><span class="math display">\[t=\frac{\bar{A}-\bar{B}}{\sqrt{\frac{S^{2}_{A}}{n}+\frac{S^{2}_{B}}{m}}} \tag{4}\]</span></span></p>
<p>Here, <span class="math inline">\(S_{A}\)</span><span class="math inline">\(S_{B}\)</span> are the variances of groups <span class="math inline">\(A\)</span><span class="math inline">\(B\)</span>, respectively (see Section X). The <em>d.f.</em> to use with Welch’s <em>t</em>-test is obtained using the Welch–Satterthwaite equation (<a href="#eq-satterthwaite" class="quarto-xref">Equation&nbsp;5</a>):</p>
<p><span id="eq-satterthwaite"><span class="math display">\[d.f. = \frac{\left( \frac{S^{2}_{A}}{n}+\frac{S^{2}_{B}}{m} \right)^{2}}{\left( \frac{S^{4}_{A}}{n-1} + \frac{S^{4}_{B}}{m-1} \right)} \tag{5}\]</span></span></p>
</div></div>
<p>What do we do with this <em>t</em>-statistic? In the olden days we had to calculate the <em>t</em>-statistics and the <em>d.f.</em> by hand. These two values, the <em>d.f.</em>, <em>t</em>-value had to be read off a table of pre-calculated <em>t</em>-values and probabilities and degrees of freedom <a href="https://home.ubalt.edu/ntsbarsh/Business-stat/StatistialTables.pdf">as in here</a>. Luckily, the <em>t</em>-test function nowadays does this all automagically. But if you are feeling nostalgic over times that you have sadly never experienced, please calculate the <em>t</em>-statistic, the <em>d.f.</em> yourself and give the table a go. In fact and an excessive later in this chapter will give you an opportunity to do so.</p>
<p>Back to the present day and the wonders of modern technology. Let us generate some new random normal data and test to see if the data belonging to the two groups differ significantly from one-another. First, we apply the <em>t</em>-test function as usual:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># random normal data</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">set.seed</span>(<span class="dv">666</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a>r_two <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">dat =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">4</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb11-4"><a href="#cb11-4"></a>                            <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>)),</span>
<span id="cb11-5"><a href="#cb11-5"></a>                    <span class="at">sample =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"A"</span>, <span class="dv">20</span>), <span class="fu">rep</span>(<span class="st">"B"</span>, <span class="dv">20</span>)))</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co"># perform t-test</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co"># note how we set the `var.equal` argument to TRUE because we know </span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co"># our data has the same SD (they are simulated as such!)</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="fu">t.test</span>(dat <span class="sc">~</span> sample, <span class="at">data =</span> r_two, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  Two Sample t-test
R&gt; 
R&gt; data:  dat by sample
R&gt; t = -1.9544, df = 38, p-value = 0.05805
R&gt; alternative hypothesis: true difference in means between group A and group B is not equal to 0
R&gt; 95 percent confidence interval:
R&gt;  -1.51699175  0.02670136
R&gt; sample estimates:
R&gt; mean in group A mean in group B 
R&gt;        4.001438        4.746584</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># if the variances are not equal, simply set `var.equal` to false</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co"># and a Welch's t-test will be performed</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The first argument we see in <code>t.test()</code> is <code>dat ~ sample</code>. Usually in R when we see a <code>~</code> (tilde) we are creating what is known as a formula. A formula tells R how it should look for interactions between data and factors. For example <code>Y ~ X</code> reads: <span class="math inline">\(Y\)</span> as a function of <span class="math inline">\(X\)</span>. In our code above we see <code>dat ~ sample</code>. This means we are telling R that the <em>t</em>-test we want it to perform is when the <code>dat</code> column is a function of the <code>sample</code> column. In plain English we are dividing up the <code>dat</code> column into the two different samples we have, and then running a <em>t</em>-test on these samples. Another way of stating this is that the value of <code>dat</code> depends on the grouping it belong to (<code>A</code> and <code>B</code>). We will see this same formula notation cropping up later under ANOVAs, linear models, etc.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Do This Now!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create a visualisation to graphically demonstrate the outcome of this <em>t</em>-test.</p>
</div>
</div>
</section>
<section id="one-sided-two-sample-t-test" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="one-sided-two-sample-t-test"><span class="header-section-number">4.2</span> One-sided Two-sample <em>t</em>-test</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Hypothesis for One-sided Two-sample <em>t</em>-test
</div>
</div>
<div class="callout-body-container callout-body">
<p>For example, when we are concerned that the sample mean of the first population, <span class="math inline">\(\bar{A}\)</span>, should be greater than that of the second, <span class="math inline">\(\bar{B}\)</span>:</p>
<p><span class="math inline">\(H_{0}: \bar{A} \le \bar{B}\)</span><span class="math inline">\(H_{a}: \bar{A} \gt \bar{B}\)</span></p>
<p>Only one of the two options is shown.</p>
</div>
</div>
<p>Just as with the one-sample <em>t</em>-tests above, we may also specify which tail of the distribution we are interested in when we compare the means of our two samples. This is a <strong>one-sided two-sample <em>t</em>-test</strong>, and here too we have the Student’s <em>t</em>-test, Welch’s <em>t</em>-test varieties. We do so by providing the same arguments as previously:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># is the mean of sample B smaller than that of sample A?</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="fu">compare_means</span>(dat <span class="sc">~</span> sample, <span class="at">data =</span> r_two,</span>
<span id="cb14-3"><a href="#cb14-3"></a>              <span class="at">method =</span> <span class="st">"t.test"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-4"><a href="#cb14-4"></a>              <span class="at">alternative =</span> <span class="st">"less"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; # A tibble: 1 × 8
R&gt;   .y.   group1 group2     p p.adj p.format p.signif method
R&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt; 
R&gt; 1 dat   A      B      0.971  0.97 0.97     ns       T-test</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># is the mean of sample B greater than that of sample A?</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">compare_means</span>(dat <span class="sc">~</span> sample, <span class="at">data =</span> r_two,</span>
<span id="cb16-3"><a href="#cb16-3"></a>              <span class="at">method =</span> <span class="st">"t.test"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-4"><a href="#cb16-4"></a>              <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; # A tibble: 1 × 8
R&gt;   .y.   group1 group2      p p.adj p.format p.signif method
R&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt; 
R&gt; 1 dat   A      B      0.0290 0.029 0.029    *        T-test</code></pre>
</div>
</div>
<p>What do these results show? Is this surprising?</p>
</section>
</section>
<section id="paired-t-tests" class="level1 page-columns page-full" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Paired <em>t</em>-tests</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Hypothesis for Two-sided Paired <em>t</em>-test
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(H_{0}: \bar{d} = 0\)</span><span class="math inline">\(H_{a}: \bar{d} \ne 0\)</span></p>
<p>where <span class="math inline">\(\bar{d}\)</span> is the mean population difference based on the matched pairs.</p>
<p>Again, here <span class="math inline">\(H_{0}\)</span> does not consider if differences are greater than or less than 0 — a difference in either direction is significant. One-sided versions of the hypothesis can be stated as well.</p>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Paired <em>t</em>-test:</strong> <span class="math display">\[t = \frac{\bar{d}}{s_d/\sqrt{n}}\]</span></p>
<p>where <span class="math inline">\(\bar{d}\)</span> is the sample mean of the differences between paired observations, <span class="math inline">\(s_d\)</span> is the sample standard deviation of the differences,<span class="math inline">\(n\)</span> is the number of pairs. The resulting <span class="math inline">\(t\)</span>-statistic is then compared to the appropriate <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom to determine the <span class="math inline">\(p\)</span>-value.</p>
</div></div><p>Paired <em>t</em>-tests are done when comparing matched samples, and in other words, when our second assumption of <em>t</em>-tests is violated: the observations are independent of one another — in paired samples, clearly they are not independent. This test is also sometimes called a dependent sample <em>t</em>-test, a repeated measures <em>t</em>-test.</p>
<p>For example, we design a survey to determine if, in a group of 20 people, individuals’ right arms differ in length from that of their left arms. For person A, we measure her right arm, her left arm. For person B we measure his right arm and his left arm. So we go all the way to person 20. A right arm belonging with one individual is always matched against a left arm in the same individual. The samples are paired so we use a paired <em>t</em>-test.</p>
<p>Another example: we follow the growth of a sample of 20 piglets over three weeks to see if they weigh more after three weeks than they did at the start of the assessment period. We measure the first piglet, named Halal, at the start of the three week period, again after. We do the same for the second piglet and Kosher. And so it goes. Each piglet has a paired set of measurements, one before matched with one after. In both these examples the data in the two groups (left arm, right arm; or before and after) are not independent and so we need to account for this in the analysis. In practice, how do we perform such a <em>t</em>-test? Who can think of a dataset we have used in the past that we would use a paired <em>t</em>-test for?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">compare_means</span>(dat <span class="sc">~</span> sample, <span class="at">data =</span> r_two,</span>
<span id="cb18-2"><a href="#cb18-2"></a>              <span class="at">method =</span> <span class="st">"t.test"</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; # A tibble: 1 × 8
R&gt;   .y.   group1 group2      p p.adj p.format p.signif method
R&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt; 
R&gt; 1 dat   A      B      0.0391 0.039 0.039    *        T-test</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Do This Now!
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Task F.3.</strong> Divide the class into two groups. In each group, collect your own data that are suitable for analysis with a paired <em>t</em>-test. State your hypothesis. Test it. Discuss. Report back comprehensively in Task F.</p>
</div>
</div>
</section>
<section id="is-there-a-difference-between-two-proportions" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Is There a Difference Between Two Proportions?</h1>
<p>All of the tests we covered above are designed to deal with continuous data, such as fish lengths, chlorophyll content. If we want to compare proportions (probabilities of success) of different samples against each other or some known population mean, we need <code>prop.test()</code>. Let us create a dummy dataset to get a better idea of how this function works. Below we create some data showing the result of placing two different subjects, Jack, Jill and in separate sealed rooms for two hours (120 minutes). Once every minute a mosquito is let into the room before being extracted again. The columns <code>yes</code> and <code>no</code> show if the mosquito bit the subject during that one minute. Who says science cannot be fun!</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>mosquito <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">50</span>, <span class="dv">35</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="fu">colnames</span>(mosquito) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="fu">rownames</span>(mosquito) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jack"</span>, <span class="st">"Jill"</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a>mosquito</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;      yes no
R&gt; Jack  70 50
R&gt; Jill  85 35</code></pre>
</div>
</div>
<section id="one-sample-and-two-sample-tests" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="one-sample-and-two-sample-tests"><span class="header-section-number">6.1</span> One-sample and Two-sample Tests</h2>
<p>As with <em>t</em>-tests, proportion tests may also be based on one sample, or two. If we have only one sample we must specify the total number of trials as well as what the expected population probability of success is. Because these are individual values, and not matrices, we will show what this would look like without using any objects but will rather give each argument within <code>prop.test()</code> a single exact value. In the arguments within <code>prop.test()</code>, <code>x</code> denotes the number of successes recorded, <code>n</code> shows the total number of individual trials performed, <code>p</code> is the expected probability. It is easiest to consider this as though it were a series of 100 coin tosses.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># When the probability matches the population</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="dv">45</span>, <span class="at">n =</span> <span class="dv">100</span>, <span class="at">p =</span> <span class="fl">0.5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  1-sample proportions test with continuity correction
R&gt; 
R&gt; data:  45 out of 100, null probability 0.5
R&gt; X-squared = 0.81, df = 1, p-value = 0.3681
R&gt; alternative hypothesis: true p is not equal to 0.5
R&gt; 95 percent confidence interval:
R&gt;  0.3514281 0.5524574
R&gt; sample estimates:
R&gt;    p 
R&gt; 0.45</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># When it does not</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="dv">33</span>, <span class="at">n =</span> <span class="dv">100</span>, <span class="at">p =</span> <span class="fl">0.5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  1-sample proportions test with continuity correction
R&gt; 
R&gt; data:  33 out of 100, null probability 0.5
R&gt; X-squared = 10.89, df = 1, p-value = 0.0009668
R&gt; alternative hypothesis: true p is not equal to 0.5
R&gt; 95 percent confidence interval:
R&gt;  0.2411558 0.4320901
R&gt; sample estimates:
R&gt;    p 
R&gt; 0.33</code></pre>
</div>
</div>
<p>If we have two samples that we would like to compare against one another we enter them into the function as follows:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># NB: Note that the `mosquito` data are a matrix, NOT a data.frame</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="fu">prop.test</span>(mosquito)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  2-sample test for equality of proportions with continuity correction
R&gt; 
R&gt; data:  mosquito
R&gt; X-squared = 3.5704, df = 1, p-value = 0.05882
R&gt; alternative hypothesis: two.sided
R&gt; 95 percent confidence interval:
R&gt;  -0.253309811  0.003309811
R&gt; sample estimates:
R&gt;    prop 1    prop 2 
R&gt; 0.5833333 0.7083333</code></pre>
</div>
</div>
<p>Do mosquito’s bite Jack and Jill at different proportions?</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Do This Now!
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Task F.4.</strong> Divide the class into two groups, Group A, Group B. In each group and collect data on 100 coin tosses. The intention is to compare the coin tosses across Groups A and B. State your hypothesis. Test it. Discuss. Report back in Task F.</p>
</div>
</div>
</section>
<section id="one-sided-and-two-sided-tests" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="one-sided-and-two-sided-tests"><span class="header-section-number">6.2</span> One-sided and Two-sided Tests</h2>
<p>As with all other tests that compare values, proportion tests may be specified as either one, two-sided. Just to be clear or the default setting for <code>prop.test()</code>, like everything else, is a two-sided test. See code below to confirm that the results are identical with, without the added argument:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># Default</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="fu">prop.test</span>(mosquito)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  2-sample test for equality of proportions with continuity correction
R&gt; 
R&gt; data:  mosquito
R&gt; X-squared = 3.5704, df = 1, p-value = 0.05882
R&gt; alternative hypothesis: two.sided
R&gt; 95 percent confidence interval:
R&gt;  -0.253309811  0.003309811
R&gt; sample estimates:
R&gt;    prop 1    prop 2 
R&gt; 0.5833333 0.7083333</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># Explicitly state two-sided test</span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="fu">prop.test</span>(mosquito, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  2-sample test for equality of proportions with continuity correction
R&gt; 
R&gt; data:  mosquito
R&gt; X-squared = 3.5704, df = 1, p-value = 0.05882
R&gt; alternative hypothesis: two.sided
R&gt; 95 percent confidence interval:
R&gt;  -0.253309811  0.003309811
R&gt; sample estimates:
R&gt;    prop 1    prop 2 
R&gt; 0.5833333 0.7083333</code></pre>
</div>
</div>
<p>Should we want to specify only one of the tails to be considered, we do so precisely the same as with t-tests. Below are examples of what this code would look like:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># Jack is bit less than Jill</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="fu">prop.test</span>(mosquito, <span class="at">alternative =</span> <span class="st">"less"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  2-sample test for equality of proportions with continuity correction
R&gt; 
R&gt; data:  mosquito
R&gt; X-squared = 3.5704, df = 1, p-value = 0.02941
R&gt; alternative hypothesis: less
R&gt; 95 percent confidence interval:
R&gt;  -1.00000000 -0.01597923
R&gt; sample estimates:
R&gt;    prop 1    prop 2 
R&gt; 0.5833333 0.7083333</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># Jack is bit more than Jill</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="fu">prop.test</span>(mosquito, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  2-sample test for equality of proportions with continuity correction
R&gt; 
R&gt; data:  mosquito
R&gt; X-squared = 3.5704, df = 1, p-value = 0.9706
R&gt; alternative hypothesis: greater
R&gt; 95 percent confidence interval:
R&gt;  -0.2340208  1.0000000
R&gt; sample estimates:
R&gt;    prop 1    prop 2 
R&gt; 0.5833333 0.7083333</code></pre>
</div>
</div>
<p>Do these results differ from the two-sided test? What is different?</p>
</section>
</section>
<section id="a-t-test-workflow" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> A <em>t</em>-test Workflow</h1>
<p>Now that we have seen how to compare the means of two sample sets of data, let us see what that complete workflow would look like in R. For this example we will use the <code>ecklonia</code> data from <a href="https://robwschlegel.github.io/Intro_R_Workshop/">Intro R Workshop: Data Manipulation, Analysis, Graphing</a>.</p>
<section id="loading-data" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="loading-data"><span class="header-section-number">7.1</span> Loading Data</h2>
<p>Before we can run any analyses we will need to load our data. We are also going to convert these data from their wide format into a long format because this is more useful for the rest of our workflow.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>ecklonia <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"BCB744"</span>, <span class="st">"ecklonia.csv"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"variable"</span>, <span class="at">value =</span> <span class="st">"value"</span>, <span class="sc">-</span>species, <span class="sc">-</span>site, <span class="sc">-</span>ID)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="visualising-data" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="visualising-data"><span class="header-section-number">7.2</span> Visualising Data</h2>
<p>With our data loaded, let us visualise them in order to ensure that these are indeed the data we are after (<a href="#fig-ecklonia1" class="quarto-xref">Figure&nbsp;2</a>). Visualising the data will also help us to formulate a hypothesis.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecklonia, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">geom_boxplot</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"dodgerblue4"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-ecklonia1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ecklonia1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-t_tests_files/figure-html/fig-ecklonia1-1.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ecklonia1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Boxplots showing differences in morphometric properties of the kelp <em>Ecklonia maxima</em> at two sites in False Bay.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The first thing we should notice from the figure above is that our different measurements are on very different scales. This makes comparing all of our data visually rather challenging. Even given this complication, one should readily be able to make out that the measurement values at Batsata Rock appear to be greater than at Boulders Beach. Within the framework of the scientific process, that is what we would call an ‘observation’, and is the first step towards formulating a hypothesis. The next step is to refine our observation into a hypothesis. By what measurement are the kelps greater at one site than the other?</p>
</section>
<section id="formulating-a-hypothesis" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="formulating-a-hypothesis"><span class="header-section-number">7.3</span> Formulating a Hypothesis</h2>
<p>Looking at the figure above it appears that for almost all measurements of length, Batsata Rock far exceeds that of Boulders Beach however, the stipe masses between the two sites appear to be more similar. Let us pull out just this variable, create a new boxplot (<a href="#fig-ecklonia2" class="quarto-xref">Figure&nbsp;3</a>).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># filter the data</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>ecklonia_sub <span class="ot">&lt;-</span> ecklonia <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"stipe_mass"</span>)</span>
<span id="cb38-4"><a href="#cb38-4"></a></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="co"># then create a new figure</span></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecklonia_sub, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>  <span class="fu">geom_boxplot</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Stipe mass (kg)"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-11"><a href="#cb38-11"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-ecklonia2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ecklonia2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-t_tests_files/figure-html/fig-ecklonia2-1.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ecklonia2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Boxplots showing the difference in stipe mass (kg) of the kelp <em>Ecklonia maxima</em> at two sites in False Bay.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Now we have a more interesting comparison at hand. The question I think of when I look at these data is “Are the stipe masses at Batsata Rock greater than at Boulders Beach?”. The hypothesis necessary to answer this question would look like this:</p>
<ul>
<li><em>H</em><sub>0</sub>: Stipe mass at Batsata Rock <strong>is not</strong> greater than at Boulders Beach.</li>
<li><em>H</em><sub>a</sub>: Stipe mass at Batsata Rock <strong>is</strong> greater than at Boulders Beach.</li>
</ul>
<p>Or more formally:</p>
<ul>
<li><span class="math inline">\(H_{0}: \bar{A} \leq \bar{B}\)</span></li>
<li><span class="math inline">\(H_{a}: \bar{A} &gt; \bar{B}\)</span>.</li>
</ul>
<p>Which test must we use for this hypothesis?</p>
</section>
<section id="choosing-a-test" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="choosing-a-test"><span class="header-section-number">7.4</span> Choosing a Test</h2>
<p>Before we can pick the correct statistical test for our hypothesis, we need to be clear on what it is we are asking. Starting with the data being used is usually a good first step. As we may see in the above figure, we have two sample sets that we are comparing. Therefore, unsurprisingly, we will likely be using a <em>t</em>-test. But we are not done yet. How is it that we are comparing these two sample sets? Remember from the examples above that there are multiple different ways to compare two sets of data. For our hypothesis we want to see if the stipe mass at Batsata Rock is <strong>greater than</strong> the stipe mass at Boulders Beach, not just that they are different. Because of this we will need a one-sided <em>t</em>-test. But wait, there is more! We have zeroed in on which sort of test would be appropriate for our hypothesis, but before we run it we need to check our assumptions.</p>
</section>
<section id="checking-assumptions" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="checking-assumptions"><span class="header-section-number">7.5</span> Checking Assumptions</h2>
<p>In case we forgot, here are the assumptions for a <em>t</em>-test:</p>
<ul>
<li>the dependent variable must be <strong>continuous</strong>,</li>
<li>the observations in the groups being compared are <strong>independent</strong> of each other,</li>
<li>the data are <strong>normally distributed</strong>,</li>
<li>that the data are <strong>homoscedastic</strong>, and in particular, that there are no outliers.</li>
</ul>
<p>We know that the first two assumptions are met because our data are measurements of mass at two different sites. Before we can run our one-sided <em>t</em>-test we must meet the last two assumptions. Lucky us, we have a function tat will do that automagically.</p>
<p>Please refer to <a href="../basic_stats/06-assumptions.html">Chapter 6</a> to see what to do if the assumptions fail.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>ecklonia_sub <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="fu">group_by</span>(site) <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="#cb39-3"></a>  <span class="fu">summarise</span>(<span class="at">stipe_mass_var =</span> <span class="fu">two_assum</span>(value)[<span class="dv">1</span>],</span>
<span id="cb39-4"><a href="#cb39-4"></a>            <span class="at">stipe_mass_norm =</span> <span class="fu">two_assum</span>(value)[<span class="dv">2</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; # A tibble: 2 × 3
R&gt;   site           stipe_mass_var stipe_mass_norm
R&gt;   &lt;chr&gt;                   &lt;dbl&gt;           &lt;dbl&gt;
R&gt; 1 Batsata Rock             2.00           0.813
R&gt; 2 Boulders Beach           2.64           0.527</code></pre>
</div>
</div>
<p>Lovely. The variances are equal and the data are normal. On to the next step.</p>
</section>
<section id="running-an-analysis" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="running-an-analysis"><span class="header-section-number">7.6</span> Running an Analysis</h2>
<p>With our assumptions checked, we may now analyse our data. We will see below how to do this with both of the functions we have learned in this chapter for comparing means of two sample sets.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">t.test</span>(value <span class="sc">~</span> site, <span class="at">data =</span> ecklonia_sub,</span>
<span id="cb41-2"><a href="#cb41-2"></a>       <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  Two Sample t-test
R&gt; 
R&gt; data:  value by site
R&gt; t = 1.8741, df = 24, p-value = 0.03657
R&gt; alternative hypothesis: true difference in means between group Batsata Rock and group Boulders Beach is greater than 0
R&gt; 95 percent confidence interval:
R&gt;  0.09752735        Inf
R&gt; sample estimates:
R&gt;   mean in group Batsata Rock mean in group Boulders Beach 
R&gt;                     6.116154                     4.996154</code></pre>
</div>
</div>
</section>
<section id="interpreting-the-results" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="interpreting-the-results"><span class="header-section-number">7.7</span> Interpreting the Results</h2>
<p>We may reject the null hypothesis that the stipe mass of kelps at Batsata Rock is not greater than at Boulders Beach if our <em>t</em>-test returns a <em>p</em>-value <span class="math inline">\(\leq\)</span> 0.05. We must also pay attention to some of the other results from our <em>t</em>-test, specifically the <em>t</em>-value (<code>t</code>) and the degrees of freedom (<code>df</code>) as these are also needed when we are writing up our results. From all of the information above, we may accept the alternative hypothesis. But how do we write that up?</p>
</section>
<section id="drawing-conclusions" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="drawing-conclusions"><span class="header-section-number">7.8</span> Drawing Conclusions</h2>
<p>There are many ways to present ones findings. Style, without <em>too much</em> flourish, is encouraged as long as certain necessary pieces of information are provided. The sentence below is a very minimalist example of how one may conclude this mini research project. A more thorough explanation would be desirable.</p>
<blockquote class="blockquote">
<p>The stipe mass (kg) of the kelp <em>Ecklonia maxima</em> was found to be significantly greater at Batsata Rock than at Boulders Beach (<em>p</em> = 0.03, <em>t</em> = 1.87, df = 24).</p>
</blockquote>
</section>
<section id="going-further" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="going-further"><span class="header-section-number">7.9</span> Going Further</h2>
<p>But why though? As is often the case in life, and science is no exception, answers to our questions just create even more questions! Why would the mass of kelp stipes at one locations in the same body of water, only a kilometre or so apart be significantly different? It looks like we are going to need to design a new experiment… Masters thesis anyone?</p>
</section>
</section>
<section id="conclusion" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Conclusion</h1>
<p><em>t</em>-tests are one of the first classes of inferential statistics students typically lerarn in a course on biostatistics. They are suitable for situations where you have two groups of data to compare and to establish if the difference between their means is zero. Lesson learned here are generalisable to more complex analysis.</p>


</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{a._j.2021,
  author = {A. J. , Smit},
  title = {7. {*t*-Tests}},
  date = {2021-01-01},
  url = {http://samos-r.netlify.app/basic_stats/07-t_tests.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-a._j.2021" class="csl-entry quarto-appendix-citeas" role="listitem">
A. J. S (2021) 7. *t*-Tests. <a href="http://samos-r.netlify.app/basic_stats/07-t_tests.html">http://samos-r.netlify.app/basic_stats/07-t_tests.html.
</a>
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("http:\/\/samos-r\.netlify\.app");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../basic_stats/06-assumptions.html" class="pagination-link" aria-label="6. Assumptions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">6. Assumptions</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../basic_stats/08-anova.html" class="pagination-link" aria-label="8. ANOVA">
        <span class="nav-page-text">8. ANOVA</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>