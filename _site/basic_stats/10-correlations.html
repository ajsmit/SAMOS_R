<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Smit, A. J.">
<meta name="dcterms.date" content="2021-01-01">

<title>10. Correlations – SAMOS R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../basic_stats/11-decision_guide.html" rel="next">
<link href="../basic_stats/09-regressions.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-21fe018c864e78632dc0e35f28f7bac9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">SAMOS R</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../intro_r/01-RStudio.html"> 
<span class="menu-text">Intro to R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../basic_stats/02-summarise-and-describe.html"> 
<span class="menu-text">Biostatistics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tasks/BCB744_Task_A.html"> 
<span class="menu-text">Tasks</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../basic_stats/02-summarise-and-describe.html">Biostatistics</a></li><li class="breadcrumb-item"><a href="../basic_stats/10-correlations.html">10. Correlations</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/SAMOS-logo-transparent.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../images/SAMOS-logo-transparent.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction to R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/01-RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/02-working-with-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Working with Data and Code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/03-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. R Markdown and Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/04-data-in-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data Classes and Structures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/05-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. R Workflows</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/06-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Graphics with <strong>ggplot2</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/07-faceting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Faceting Figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/08-brewing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Brewing Colours</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/09-mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Mapping with <strong>ggplot2</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/10-mapping_style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Mapping with Style</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/11-mapping_rnaturalearth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Mapping with Natural Earth</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/12-mapping_quakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. The Fiji Earthquake Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/13-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Tidy Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/14-tidier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Tidier Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/15-tidiest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15. Tidiest Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/16-recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16. Synthesis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/17-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17. Functions by Chapter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/18-base_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">18. Base R Primer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_r/19-dates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">19. Dates</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Biostatistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/02-summarise-and-describe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Data Summaries &amp; Descriptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/03-visualise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Statistical Figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/04-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/05-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Statistical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/06-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Assumptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/07-t_tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. <em>t</em>-Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/08-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/09-regressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Simple Linear Regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/10-correlations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">10. Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/11-decision_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Parametric Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/12-glance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Non-Parametric Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/13-confidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Confidence Intervals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_stats/14-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Data Transformations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Tasks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_A.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_B.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task B</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_C.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task C</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_D.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Bonus Task</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_E.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task E</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_F.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task F</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_G.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task G</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_H.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Task G</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tasks/BCB744_Task_Bonus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Bonus Task</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#at-a-glance" id="toc-at-a-glance" class="nav-link active" data-scroll-target="#at-a-glance"><span class="header-section-number">1</span> At a Glance</a></li>
  <li><a href="#introduction-to-correlation" id="toc-introduction-to-correlation" class="nav-link" data-scroll-target="#introduction-to-correlation"><span class="header-section-number">2</span> Introduction to Correlation</a></li>
  <li><a href="#pearson-correlation" id="toc-pearson-correlation" class="nav-link" data-scroll-target="#pearson-correlation"><span class="header-section-number">3</span> Pearson Correlation</a></li>
  <li><a href="#spearman-rank-correlation" id="toc-spearman-rank-correlation" class="nav-link" data-scroll-target="#spearman-rank-correlation"><span class="header-section-number">4</span> Spearman Rank Correlation</a></li>
  <li><a href="#kendall-rank-correlation" id="toc-kendall-rank-correlation" class="nav-link" data-scroll-target="#kendall-rank-correlation"><span class="header-section-number">5</span> Kendall Rank Correlation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../basic_stats/02-summarise-and-describe.html">Biostatistics</a></li><li class="breadcrumb-item"><a href="../basic_stats/10-correlations.html">10. Correlations</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">10. Correlations</h1>
<p class="subtitle lead">The Association Between Continuous Variables</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Smit, A. J. <a href="https://orcid.org/0000-0002-3799-6126" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://uwc.ac.za">
            University of the Western Cape
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 1, 2021</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><img src="../images/SAMOS-logo-transparent.png" class="img-fluid" style="width:35.0%"></p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>In This Chapter
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Correlations</li>
<li>Pearson’s product moment correlation</li>
<li>Paired correlations</li>
<li>Spearman rank correlation</li>
<li>Kendal rank correlation</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Cheatsheet
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find here a <a href="../../docs/Methods_cheatsheet_v1.pdf">Cheatsheet</a> on statistical methods.</p>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Slides with Additional Information About Correlations
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="../../slides/BCB744_Correlations_slides--1-.html">Slide deck 1</a></li>
<li><a href="../../slides/BCB744_Correlations_slides--2-.html">Slide deck 2</a></li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Tasks to Complete in This Chapter
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Task Η</li>
</ul>
</div>
</div>
<section id="at-a-glance" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="at-a-glance"><span class="header-section-number">1</span> At a Glance</h2>
<p>Correlation analysis is used to quantify the <em>strength and direction of the linear relationship between two continuous variables</em>. The expectations about the data needed for a correlation analysis are:</p>
<ul>
<li><p><strong>Continuous variables</strong> Both variables should be measured on a continuous scale (<em>e.g.</em>, height, depth, income). Note that we <em>do not have dependent, independent variables</em> as no dependency of one variable upon the other is implied.</p></li>
<li><p><strong>Bivariate relationship</strong> Correlation analysis is used to assess the relationship between two variables at a time. If you are interested in the relationship between multiple variables, you may need to consider pairwise correlations, or other multivariate techniques such as multiple regression, canonical correlation.</p></li>
<li><p><strong>Linear relationship</strong> The relationship between the two variables should be linear. This can be visually assessed using scatter plots. If the relationship is not linear, you may need to consider non-linear correlation measures, such as Spearman’s <span class="math inline">\(\rho\)</span> correlation or Kendall’s <span class="math inline">\(\tau\)</span>.</p></li>
<li><p><strong>No outliers</strong> Outliers can have a strong influence on the correlation coefficient, potentially leading to misleading conclusions. It is important to visually inspect the data using scatter plots, address any outliers before performing correlation analysis.</p></li>
<li><p><strong>Normality</strong> While not strictly required for correlation analysis, the assumption of bivariate normality can be important when making inferences about the population correlation coefficient. If the variables are not normally distributed, have a non-linear relationship or consider using non-parametric correlation measures like Spearman’s <span class="math inline">\(\rho\)</span> correlation or Kendall’s <span class="math inline">\(\tau\)</span>.</p></li>
<li><p><strong>Independence of observations</strong> The observations should be independent of each other. In the case of time series data or clustered data, this assumption may be violated, requiring specific techniques to account for the dependence (<em>e.g.</em>, autocorrelation, cross-correlation).</p></li>
<li><p><strong>Random sampling</strong> The data should be obtained through random sampling, ensuring that each observation has an equal chance of being included in the sample.</p></li>
</ul>
<p>Keep in mind that correlation does not imply causation; it only describes the association between variables without establishing a cause-and-effect relationship. When the intention is to model causation you will need to apply a regression.</p>
</section>
<section id="introduction-to-correlation" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="introduction-to-correlation"><span class="header-section-number">2</span> Introduction to Correlation</h2>
<p>A correlation is performed when we want to investigate the potential <em>association</em> between two continuous quantitative variables, or between some ordinal variables. We assume that the association is linear, like in a linear regression, and that one variable increases, decreases by a constant amount for a corresponding unit increase or decrease in the other variable. This does not suggest that one variable explains the other — that is the purpose of regression or as seen in <a href="../basic_stats/09-regressions.html">Chapter 9</a>. Like all statistical tests, correlation requires a series of assumptions:</p>
<ul>
<li>pair-wise data</li>
<li>absence of outliers</li>
<li>linearity</li>
<li>normality of distribution</li>
<li>homoscedasticity</li>
<li>level (type) of measurement</li>
<li>continuous data (Pearson <span class="math inline">\(r\)</span>)</li>
<li>non-parametric correlations (Spearman’s <span class="math inline">\(\rho\)</span> and Kendall’s <span class="math inline">\(\tau\)</span>)</li>
</ul>
</section>
<section id="pearson-correlation" class="level2 page-columns page-full" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="pearson-correlation"><span class="header-section-number">3</span> Pearson Correlation</h2>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Pearson’s <span class="math inline">\(r\)</span>:</strong></p>
<p><span id="eq-pearson"><span class="math display">\[r_{xy} = \frac{\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^{n}(x_i - \bar{x})^2}\sqrt{\sum_{i=1}^{n}(y_i - \bar{y})^2}} \tag{1}\]</span></span></p>
<p>where <span class="math inline">\(r_{xy}\)</span> is the Pearson correlation coefficient, <span class="math inline">\(x_i\)</span><span class="math inline">\(y_i\)</span> are the observed values of the two variables for each observation <span class="math inline">\(i\)</span>, <span class="math inline">\(\bar{x}\)</span><span class="math inline">\(\bar{y}\)</span> are the sample means of the two variables,<span class="math inline">\(n\)</span> is the sample size.</p>
</div></div><p>Pearson’s <span class="math inline">\(r\)</span> is a measure of the linear relationship between two variables. It assumes that the relationship between the variables is linear, and is calculated as the ratio of the covariance between the variables to the product of their standard deviations (<a href="#eq-pearson" class="quarto-xref">Equation&nbsp;1</a>).</p>
<p>The degree of association is measured by a correlation coefficient, denoted by <span class="math inline">\(r\)</span> (note, in a regression we use the <span class="math inline">\(r^{2}\)</span>,<span class="math inline">\(R^{2}\)</span>). The <span class="math inline">\(r\)</span> statistic is a measure of linear association. The value for <span class="math inline">\(r\)</span> varies from -1 to 1, with 0 indicating that there is absolutely no association, 1 showing a perfect positive association, and -1 a perfect inverse correlation.</p>
<p>In order to investigate correlations in biological data lets load the <code>ecklonia</code> dataset.</p>
<div id="tbl-library-tidyverse" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-library-tidyverse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1
</figcaption>
<div aria-describedby="tbl-library-tidyverse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Load libraries</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># Load data</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>ecklonia <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"BCB744"</span>, <span class="st">"ecklonia.csv"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<p>We will also create a subsetted version of our data by removing all of the categorical variables. If we have a dataframe where each column represents pair-wise continuous/ordinal measurements with all of the other columns we may very quickly and easily perform a much wider range of correlation analyses.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>ecklonia_sub <span class="ot">&lt;-</span> ecklonia <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">select</span>(<span class="sc">-</span>species, <span class="sc">-</span> site, <span class="sc">-</span> ID)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># order the columns alphabetically</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>ecklonia_sub <span class="ot">&lt;-</span> ecklonia_sub[,<span class="fu">order</span>(<span class="fu">colnames</span>(ecklonia_sub))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>When the values we are comparing are continuous, we may use a Pearson test. This is the default, so requires little work on our end. The resulting statistic from this test is known as the Pearson correlation coefficient:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Perform correlation analysis on two specific variables</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co"># Note that we do not need the final two arguments in this function to be stated</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># as they are the default settings.</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># They are only shown here to illustrate that they exist.</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="fu">cor.test</span>(<span class="at">x =</span> ecklonia<span class="sc">$</span>stipe_length, ecklonia<span class="sc">$</span>frond_length,</span>
<span id="cb3-6"><a href="#cb3-6"></a>         <span class="at">use =</span> <span class="st">"everything"</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  Pearson's product-moment correlation
R&gt; 
R&gt; data:  ecklonia$stipe_length and ecklonia$frond_length
R&gt; t = 4.2182, df = 24, p-value = 0.0003032
R&gt; alternative hypothesis: true correlation is not equal to 0
R&gt; 95 percent confidence interval:
R&gt;  0.3548169 0.8300525
R&gt; sample estimates:
R&gt;       cor 
R&gt; 0.6524911</code></pre>
</div>
</div>
<p>Above we have tested the correlation between the length of <em>Ecklonia maxima</em> stipes and the length of their fronds. A perfect positive (negative) relationship would produce a value of 1 (-1), whereas no relationship would produce a value of 0. The result above, <code>cor = 0.65</code> is relatively strong.</p>
<p>As is the case with everything else we have learned thus far, a good visualisation can go a long way to help us understand what the statistics are doing. Below we visualise the stipe length to frond length relationship.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Calculate Pearson r beforehand for plotting</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>r_print <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"r = "</span>,</span>
<span id="cb5-3"><a href="#cb5-3"></a>                  <span class="fu">round</span>(<span class="fu">cor</span>(<span class="at">x =</span> ecklonia<span class="sc">$</span>stipe_length, ecklonia<span class="sc">$</span>frond_length),<span class="dv">2</span>))</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># Then create a single panel showing one correlation</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecklonia, <span class="fu">aes</span>(<span class="at">x =</span> stipe_length, <span class="at">y =</span> frond_length)) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">colour =</span> <span class="st">"blue3"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"red3"</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="fu">geom_label</span>(<span class="at">x =</span> <span class="dv">300</span>, <span class="at">y =</span> <span class="dv">240</span>, <span class="at">label =</span> r_print) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Stipe length (cm)"</span>, <span class="at">y =</span> <span class="st">"Frond length (cm)"</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="fu">theme_pubclean</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-corr1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-corr1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="10-correlations_files/figure-html/fig-corr1-1.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-corr1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Scatterplot showing relationship between <em>Ecklonia maxima</em> stipe length (cm) and frond length (cm). The correlation coefficient (Pearson <em>r</em>) is shown in the top left corner. Note that the best fit blue line was produced by a linear model and that it is not responsible for generating the correlation coefficient; rather it is included to help visually demonstrate the strength of the relationship.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Just by eye-balling this scatterplot it should be clear that these data tend to increase at a roughly similar rate. Our Pearson r value is an indication of what that is.</p>
<p>Should our dataset contain multiple variables, as <code>ecklonia</code> does, we may investigate all of the correlations simultaneously. Remember that in order to do so we want to ensure that we may perform the same test on each of our paired variables. In this case we will use <code>ecklonia_sub</code> as we know that it contains only continuous data and so are appropriate for use with a Pearson test. By default R will use all of the data we give it and perform a Pearson test so we do not need to specify any further arguments. Note however that this will only output the correlation coefficients, and does not produce a full test of each correlation. This will however be useful for us to have just now.</p>
<div class="cell page-columns page-full">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>ecklonia_pearson <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(ecklonia_sub), <span class="dv">2</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>ecklonia_pearson <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"A pairwise matrix of the *Ecklonia* dataset."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="tbl-ecklonia-pearson-round-cor-ecklonia-sub" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ecklonia-pearson-round-cor-ecklonia-sub-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: A pairwise matrix of the *Ecklonia* dataset.
</figcaption>
<div aria-describedby="tbl-ecklonia-pearson-round-cor-ecklonia-sub-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="cell-output-display column-page">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">digits</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">epiphyte_length</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">frond_length</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">frond_mass</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">primary_blade_length</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">primary_blade_width</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">stipe_diameter</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">stipe_length</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">stipe_mass</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">digits</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">epiphyte_length</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frond_length</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.39</td>
</tr>
<tr class="even">
<td style="text-align: left;">frond_mass</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">primary_blade_length</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">primary_blade_width</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.83</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stipe_diameter</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.82</td>
</tr>
<tr class="even">
<td style="text-align: left;">stipe_length</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.58</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stipe_mass</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>How would we visualise this matrix of correlations? It is relatively straightforward to quickly plot correlation results for all of our variables in one go. In order to show which variables associate most with which other variables all at once, without creating chaos, we will create what is known as a pairwise correlation plot. This visualisation uses a range of colours, usually blue to red, to demonstrate where more of something is. In this case, we use it to show where more correlation is occurring between morphometric properties of the kelp <em>Ecklonia maxima</em>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># extract the lower triangle and plot</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>ecklonia_pearson[<span class="fu">upper.tri</span>(ecklonia_pearson)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">corrplot</span>(ecklonia_pearson, <span class="at">method =</span> <span class="st">"circle"</span>, <span class="at">na.label.col =</span> <span class="st">"white"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="10-correlations_files/figure-html/code-corr2-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption>Plot of pairwise correlations showing the strength of all correlations between all variables as a scale from red (negative) to blue (positive).</figcaption>
</figure>
</div>
</div>
</div>
<p>Let us do it is <strong>ggplot2</strong> (<a href="#fig-corr3" class="quarto-xref">Figure&nbsp;2</a>). Here I use the <code>geom_tile()</code> function. However, before I can use the data in <strong>ggplot2</strong>, I need to create a long dataframe from the correlation matrix, and I can do this with the <code>pivot_longer()</code> function. There are several other methods for plotting pairwise correlations available — please feel free to scratch around the internet for options you like. This graph is called a heatmap, which is not dissimilar to the heatmaps, Hovmöller diagrams created in <a href="../basic_stats/03-visualise.html#sec-heatmaps">Chapter 2</a>.</p>
<p>Pairwise correlations are useful for identifying patterns and relationships between variables that may be hidden in the overall correlation structure of the dataset. This is particularly useful in a large dataset with many variables, where this type of analysis — especially when coupled with a suitable visualisation — can help identify subsets of variables that are strongly related to each other, which can then point the path to further analysis, modelling.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>ecklonia_pearson <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">rownames</span>(ecklonia_pearson)) <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> stipe_length<span class="sc">:</span>epiphyte_length,</span>
<span id="cb8-5"><a href="#cb8-5"></a>               <span class="at">names_to =</span> <span class="st">"y"</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>               <span class="at">values_to =</span> <span class="st">"r"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">"digits"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y, <span class="at">fill =</span> r)) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="fu">geom_tile</span>(<span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb8-11"><a href="#cb8-11"></a>                         <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb8-12"><a href="#cb8-12"></a>                          <span class="at">na.value =</span> <span class="st">"grey95"</span>,, <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb8-13"><a href="#cb8-13"></a>                         <span class="at">name =</span> <span class="st">"r"</span>) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>    <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>,</span>
<span id="cb8-17"><a href="#cb8-17"></a>                                     <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="fu">coord_fixed</span>() </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-corr3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-corr3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="10-correlations_files/figure-html/fig-corr3-1.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-corr3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Pairwise of the <em>Ecklonia</em> dataset correlations created in <strong>ggplot2</strong>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="spearman-rank-correlation" class="level2 page-columns page-full" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="spearman-rank-correlation"><span class="header-section-number">4</span> Spearman Rank Correlation</h2>
<p>Spearman correlation is used to measure the strength and direction of the relationship between two variables, based on their rank order. Unlike Pearson correlation, which assumes that the relationship between two variables is linear, Spearman correlation can be used to measure the strength of any monotonic relationship, whether it is linear, not. Additionally or this correlation is useful even when the data are not normally distributed, or contain outliers.</p>
<p>To calculate the Spearman correlation coefficient, <span class="math inline">\(\rho\)</span>, the values of both variables are first ranked from lowest to highest and each value is assigned a numerical rank based on its position in the ordered list. Then, the difference between the ranks of the two variables is calculated for each observation, and the squared differences are summed across all observations. The Spearman correlation coefficient is then calculated as the ratio of the sum of the squared differences to the total number of observations, adjusted for ties (<a href="#eq-spearman" class="quarto-xref">Equation&nbsp;2</a>). Like the Pearson correlation coefficient, <span class="math inline">\(\rho\)</span> can also range from -1 to +1.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Spearman’s <span class="math inline">\(\rho\)</span>:</strong> <span id="eq-spearman"><span class="math display">\[\rho = 1 - \frac{6 \sum_{i=1}^n d_i^2}{n(n^2-1)} \tag{2}\]</span></span></p>
<p>where <span class="math inline">\(\rho\)</span> is the Spearman correlation, <span class="math inline">\(d_i\)</span> is the difference between the ranks of the two variables for the <span class="math inline">\(i^{th}\)</span> observation,<span class="math inline">\(n\)</span> is the sample size. The factor of 6 in the equation is a normalisation constant that adjusts the range of possible values of the correlation coefficient to be between -1 and +1.</p>
</div></div><p>In the code below we will add a column of ordinal data to our <code>ecklonia</code> data to so that we may look at this test.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Create ordinal data</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>ecklonia<span class="sc">$</span>length <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">cut</span>((ecklonia<span class="sc">$</span>stipe_length <span class="sc">+</span> ecklonia<span class="sc">$</span>frond_length), <span class="at">breaks =</span> <span class="dv">3</span>))</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># What does this new column look like?</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="fu">head</span>(<span class="fu">select</span>(ecklonia, <span class="fu">c</span>(species, site, stipe_length, frond_length, length)), <span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;    species           site stipe_length frond_length length
R&gt; 1   maxima Boulders Beach          456          116      1
R&gt; 2   maxima Boulders Beach          477          141      2
R&gt; 3   maxima Boulders Beach          427          144      1
R&gt; 4   maxima Boulders Beach          347          127      1
R&gt; 5   maxima Boulders Beach          470          160      2
R&gt; 6   maxima Boulders Beach          478          181      2
R&gt; 7   maxima Boulders Beach          472          174      2
R&gt; 8   maxima Boulders Beach          459           95      1
R&gt; 9   maxima Boulders Beach          397           87      1
R&gt; 10  maxima Boulders Beach          541          127      2</code></pre>
</div>
</div>
<p>Now let us correlate the new <code>length</code> variable with any one of the other variables:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">cor.test</span>(ecklonia<span class="sc">$</span>length, ecklonia<span class="sc">$</span>digits, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  Spearman's rank correlation rho
R&gt; 
R&gt; data:  ecklonia$length and ecklonia$digits
R&gt; S = 1930, p-value = 0.08906
R&gt; alternative hypothesis: true rho is not equal to 0
R&gt; sample estimates:
R&gt;       rho 
R&gt; 0.3401765</code></pre>
</div>
</div>
</section>
<section id="kendall-rank-correlation" class="level2 page-columns page-full" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="kendall-rank-correlation"><span class="header-section-number">5</span> Kendall Rank Correlation</h2>
<p>Kendall’s correlation, also known as Kendall’s <span class="math inline">\(\tau\)</span>, is a non-parametric correlation method for assessing the strength and direction of the relationship between two variables. It is similar to Spearman’s rank correlation, but it is calculated differently.</p>
<p>Kendall’s <span class="math inline">\(\tau\)</span> is calculated based on the number of concordant and discordant pairs of observations between the two variables being correlated. A concordant pair is one in which the values of both variables have the same order, meaning that if the value of one variable is higher than the other for one observation, it is also higher for the other observation. A discordant pair is one in which the values of the two variables have different order, meaning that if one variable is higher than the other for one observation, it is lower for the other observation.</p>
<p><span class="math inline">\(\tau\)</span> is calculated as the difference between the number of concordant and discordant pairs of observations, divided by the total number of possible pairs (<a href="#eq-kendall" class="quarto-xref">Equation&nbsp;3</a>). As in Pearson’s, Spearman’s correlations and the result also ranges from -1 and +1.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Kendal’s <span class="math inline">\(\tau\)</span>:</strong> <span id="eq-kendall"><span class="math display">\[\tau = \frac{n_c - n_d}{\binom{n}{2}} \tag{3}\]</span></span></p>
<p>where <span class="math inline">\(\tau\)</span> is Kendall’s <span class="math inline">\(\tau\)</span> correlation coefficient, <span class="math inline">\(n\)</span> is the sample size, <span class="math inline">\(n_c\)</span> is the number of concordant pairs of observations, <span class="math inline">\(n_d\)</span> is the number of discordant pairs of observations,<span class="math inline">\(\binom{n}{2}\)</span> is the number of possible pairs of observations in the sample.</p>
</div></div><p>Kendall’s <span class="math inline">\(\tau\)</span> is a useful correlation statistic for non-parametric data, such as ordinal, categorical data and is robust to outliers and non-normal distributions.</p>
<p>Let us look at the normality of our <code>ecklonia</code> variables and pull out those that are not normal in order to see how the results of this test may differ from our Pearson tests.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>ecklonia_norm <span class="ot">&lt;-</span> ecklonia_sub <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">summarise</span>(<span class="at">variable_norm =</span> <span class="fu">as.numeric</span>(<span class="fu">shapiro.test</span>(value)[<span class="dv">2</span>]))</span>
<span id="cb13-5"><a href="#cb13-5"></a>ecklonia_norm</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; # A tibble: 9 × 2
R&gt;   variable             variable_norm
R&gt;   &lt;chr&gt;                        &lt;dbl&gt;
R&gt; 1 digits                     0.0671 
R&gt; 2 epiphyte_length            0.626  
R&gt; 3 frond_length               0.202  
R&gt; 4 frond_mass                 0.277  
R&gt; 5 primary_blade_length       0.00393
R&gt; 6 primary_blade_width        0.314  
R&gt; 7 stipe_diameter             0.170  
R&gt; 8 stipe_length               0.213  
R&gt; 9 stipe_mass                 0.817</code></pre>
</div>
</div>
<p>From this analysis we may see that the values for primary blade length are not normally distributed. In order to make up for this violation of our assumption of normality we may use the Kendall test.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">cor.test</span>(ecklonia<span class="sc">$</span>primary_blade_length, ecklonia<span class="sc">$</span>primary_blade_width, <span class="at">method =</span> <span class="st">"kendall"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; 
R&gt;  Kendall's rank correlation tau
R&gt; 
R&gt; data:  ecklonia$primary_blade_length and ecklonia$primary_blade_width
R&gt; z = 2.3601, p-value = 0.01827
R&gt; alternative hypothesis: true tau is not equal to 0
R&gt; sample estimates:
R&gt;       tau 
R&gt; 0.3426171</code></pre>
</div>
</div>
<p>Here the correlation coefficient is called Kendall’s <span class="math inline">\(\tau\)</span> but it is interpreted as we would Pearson’s.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{a._j.2021,
  author = {A. J. , Smit},
  title = {10. {Correlations}},
  date = {2021-01-01},
  url = {http://samos-r.netlify.app/basic_stats/10-correlations.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-a._j.2021" class="csl-entry quarto-appendix-citeas" role="listitem">
A. J. S (2021) 10. Correlations. <a href="http://samos-r.netlify.app/basic_stats/10-correlations.html">http://samos-r.netlify.app/basic_stats/10-correlations.html.
</a>
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("http:\/\/samos-r\.netlify\.app");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../basic_stats/09-regressions.html" class="pagination-link" aria-label="9. Simple Linear Regressions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">9. Simple Linear Regressions</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../basic_stats/11-decision_guide.html" class="pagination-link" aria-label="11. Parametric Tests">
        <span class="nav-page-text">11. Parametric Tests</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>